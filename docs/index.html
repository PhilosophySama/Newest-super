<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Walker Awning Triggers Map</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            margin-bottom: 30px;
        }

        h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #666;
            font-size: 1.1em;
        }

        .search-bar {
            width: 100%;
            padding: 15px 20px;
            font-size: 16px;
            border: 2px solid #ddd;
            border-radius: 10px;
            margin-top: 20px;
            transition: all 0.3s;
        }

        .search-bar:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab {
            background: white;
            padding: 12px 24px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
            font-weight: 600;
            color: #666;
        }

        .tab:hover {
            background: #f8f9ff;
            border-color: #667eea;
        }

        .tab.active {
            background: #667eea;
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .trigger-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(450px, 1fr));
            gap: 20px;
        }

        .trigger-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            transition: all 0.3s;
            cursor: pointer;
        }

        .trigger-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .trigger-card.hidden {
            display: none;
        }

        .trigger-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .trigger-name {
            font-size: 1.5em;
            font-weight: bold;
            color: #667eea;
        }

        .trigger-icon {
            font-size: 2em;
        }

        .trigger-sheets {
            display: flex;
            gap: 8px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .sheet-badge {
            background: #f0f0f0;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
            color: #666;
        }

        .sheet-badge.leads { background: #e3f2fd; color: #1976d2; }
        .sheet-badge.fu { background: #fff3e0; color: #f57c00; }
        .sheet-badge.awarded { background: #e8f5e9; color: #388e3c; }
        .sheet-badge.heaven { background: #f3e5f5; color: #7b1fa2; }

        .trigger-description {
            color: #666;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .trigger-details {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .trigger-card.expanded .trigger-details {
            max-height: 2000px;
        }

        .expand-icon {
            transition: transform 0.3s;
        }

        .trigger-card.expanded .expand-icon {
            transform: rotate(180deg);
        }

        .code-section {
            margin-top: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            border-left: 4px solid #667eea;
        }

        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .code-title {
            font-weight: 600;
            color: #333;
            font-size: 0.9em;
        }

        .copy-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.85em;
            transition: all 0.2s;
        }

        .copy-btn:hover {
            background: #5568d3;
        }

        .copy-btn:active {
            transform: scale(0.95);
        }

        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.5;
        }

        .keyword { color: #f92672; }
        .string { color: #e6db74; }
        .comment { color: #75715e; }
        .function { color: #66d9ef; }

        .output-section {
            margin-top: 15px;
            background: #fff9e6;
            border-radius: 8px;
            padding: 15px;
            border-left: 4px solid #ffc107;
        }

        .output-title {
            font-weight: 600;
            color: #f57f17;
            margin-bottom: 10px;
        }

        .output-content {
            color: #666;
            line-height: 1.6;
            font-size: 0.95em;
        }

        .stats-panel {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .stat-item {
            text-align: center;
            padding: 20px;
            background: #f8f9ff;
            border-radius: 10px;
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            color: #667eea;
        }

        .stat-label {
            color: #666;
            margin-top: 5px;
            font-size: 0.9em;
        }

        .no-results {
            text-align: center;
            padding: 60px 20px;
            color: #999;
            font-size: 1.2em;
        }

        @media (max-width: 768px) {
            .trigger-grid {
                grid-template-columns: 1fr;
            }

            h1 {
                font-size: 1.8em;
            }

            .tabs {
                overflow-x: auto;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üéØ Walker Awning Triggers Map</h1>
            <p class="subtitle">Interactive guide to all automation triggers and how to customize them</p>
            <input type="text" class="search-bar" id="searchInput" placeholder="üîç Search triggers... (e.g., 'email', 'print', 'awarded')">
        </header>

        <div class="stats-panel">
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-number" id="draftCount">6</div>
                    <div class="stat-label">Draft Triggers</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="moveCount">8</div>
                    <div class="stat-label">Move Triggers</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="autoCount">7</div>
                    <div class="stat-label">Auto Triggers</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="totalCount">21</div>
                    <div class="stat-label">Total Triggers</div>
                </div>
            </div>
        </div>

        <div class="tabs">
            <div class="tab active" data-tab="drafts">üìß Draft Creator</div>
            <div class="tab" data-tab="moves">üîÑ Row Movements</div>
            <div class="tab" data-tab="special">üìÖ Special Actions</div>
            <div class="tab" data-tab="auto">‚öôÔ∏è Auto Column Triggers</div>
            <div class="tab" data-tab="other">üìä Other Automations</div>
        </div>

        <!-- DRAFT CREATOR TAB -->
        <div class="tab-content active" id="drafts">
            <div class="trigger-grid">
                <!-- Test Trigger -->
                <div class="trigger-card" data-keywords="test draft liz email proposal review">
                    <div class="trigger-header">
                        <div class="trigger-name">test</div>
                        <div class="trigger-icon">üìß</div>
                    </div>
                    <div class="trigger-sheets">
                        <span class="sheet-badge leads">Leads</span>
                        <span class="sheet-badge fu">F/U</span>
                        <span class="sheet-badge awarded">Awarded</span>
                        <span class="sheet-badge heaven">Heaven</span>
                    </div>
                    <div class="trigger-description">
                        Creates a draft email to Liz with PICS, Re-cover snapshot, Google Earth, and QuickBooks links
                    </div>
                    <div class="trigger-details">
                        <div class="output-section">
                            <div class="output-title">üì¨ Email Output</div>
                            <div class="output-content">
                                <strong>To:</strong> Liz@WalkerAwning.com<br>
                                <strong>Subject:</strong> Proposal Review: [Display Name] - [Job Type]<br>
                                <strong>Contains:</strong> PICS link, Re-cover PNG/HTML, Earth link, QB link<br>
                                <strong>Column B:</strong> Clickable draft link created
                            </div>
                        </div>
                        <div class="code-section">
                            <div class="code-header">
                                <span class="code-title">üìù How to Add Trigger Words</span>
                                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                            </div>
                            <pre class="code-block"><span class="comment">// File: Draft Creator.gs (around line 160)</span>
<span class="comment">// Find this line:</span>
<span class="keyword">if</span> (newValLower === String(DRAFTS_V2.TARGET_STAGE).toLowerCase()) {

<span class="comment">// Change to add your words:</span>
<span class="keyword">if</span> (newValLower === String(DRAFTS_V2.TARGET_STAGE).toLowerCase() || 
    newValLower === <span class="string">'draft'</span> || 
    newValLower === <span class="string">'create draft'</span> ||
    newValLower === <span class="string">'your word here'</span>) {</pre>
                        </div>
                    </div>
                </div>

                <!-- Liz Trigger -->
                <div class="trigger-card" data-keywords="liz search find email existing">
                    <div class="trigger-header">
                        <div class="trigger-name">Liz</div>
                        <div class="trigger-icon">üîç</div>
                    </div>
                    <div class="trigger-sheets">
                        <span class="sheet-badge leads">Leads</span>
                        <span class="sheet-badge fu">F/U</span>
                        <span class="sheet-badge awarded">Awarded</span>
                        <span class="sheet-badge heaven">Heaven</span>
                    </div>
                    <div class="trigger-description">
                        Searches for existing email with "Proposal Review: [Display Name]" subject and creates clickable link in column B
                    </div>
                    <div class="trigger-details">
                        <div class="output-section">
                            <div class="output-title">üîé Search Output</div>
                            <div class="output-content">
                                Searches last 90 days for email matching:<br>
                                <strong>Subject:</strong> "Proposal Review: [Display Name]"<br>
                                <strong>Max Results:</strong> 10 emails<br>
                                <strong>Column B:</strong> Link to found email/draft or "not found" message
                            </div>
                        </div>
                        <div class="code-section">
                            <div class="code-header">
                                <span class="code-title">üìù How to Add Trigger Words</span>
                                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                            </div>
                            <pre class="code-block"><span class="comment">// File: Draft Creator.gs (around line 167)</span>
<span class="keyword">if</span> (newValLower === String(DRAFTS_V2.LIZ_STAGE).toLowerCase() || 
    newValLower === <span class="string">'search email'</span> || 
    newValLower === <span class="string">'find email'</span> ||
    newValLower === <span class="string">'your word here'</span>) {</pre>
                        </div>
                    </div>
                </div>

                <!-- Email Customer Trigger -->
                <div class="trigger-card" data-keywords="email customer follow up quote">
                    <div class="trigger-header">
                        <div class="trigger-name">Email customer</div>
                        <div class="trigger-icon">üì®</div>
                    </div>
                    <div class="trigger-sheets">
                        <span class="sheet-badge leads">Leads</span>
                        <span class="sheet-badge fu">F/U</span>
                        <span class="sheet-badge awarded">Awarded</span>
                        <span class="sheet-badge heaven">Heaven</span>
                    </div>
                    <div class="trigger-description">
                        Creates customer follow-up draft with quote details and QuickBooks link button
                    </div>
                    <div class="trigger-details">
                        <div class="output-section">
                            <div class="output-title">üì¨ Email Output</div>
                            <div class="output-content">
                                <strong>To:</strong> Customer email (Column I)<br>
                                <strong>Subject:</strong> Your awning quote from Walker Awning - [Display Name]<br>
                                <strong>Body:</strong> Thank you message with project details and QB link<br>
                                <strong>Column B:</strong> Draft link created
                            </div>
                        </div>
                        <div class="code-section">
                            <div class="code-header">
                                <span class="code-title">üìù How to Add Trigger Words</span>
                                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                            </div>
                            <pre class="code-block"><span class="comment">// File: Draft Creator.gs (around line 174)</span>
<span class="keyword">if</span> (newValLower === String(DRAFTS_V2.CUSTOMER_STAGE).toLowerCase() || 
    newValLower === <span class="string">'customer email'</span> || 
    newValLower === <span class="string">'follow up'</span> ||
    newValLower === <span class="string">'your word here'</span>) {</pre>
                        </div>
                    </div>
                </div>

                <!-- Cust Handoff Trigger -->
                <div class="trigger-card" data-keywords="handoff customer transfer michael">
                    <div class="trigger-header">
                        <div class="trigger-name">Cust Handoff</div>
                        <div class="trigger-icon">ü§ù</div>
                    </div>
                    <div class="trigger-sheets">
                        <span class="sheet-badge leads">Leads</span>
                        <span class="sheet-badge fu">F/U</span>
                        <span class="sheet-badge awarded">Awarded</span>
                        <span class="sheet-badge heaven">Heaven</span>
                    </div>
                    <div class="trigger-description">
                        Creates customer handoff draft explaining Michael's departure and requesting project info
                    </div>
                    <div class="trigger-details">
                        <div class="output-section">
                            <div class="output-title">üì¨ Email Output</div>
                            <div class="output-content">
                                <strong>To:</strong> Customer email<br>
                                <strong>Subject:</strong> Re: Your Walker Awning Project - [Display Name]<br>
                                <strong>Body:</strong> Michael transition message requesting photos and details<br>
                                <strong>Column B:</strong> Draft link created
                            </div>
                        </div>
                        <div class="code-section">
                            <div class="code-header">
                                <span class="code-title">üìù How to Add Trigger Words</span>
                                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                            </div>
                            <pre class="code-block"><span class="comment">// File: Draft Creator.gs (around line 181)</span>
<span class="keyword">if</span> (newValLower === String(DRAFTS_V2.HANDOFF_STAGE).toLowerCase() || 
    newValLower === <span class="string">'handoff'</span> || 
    newValLower === <span class="string">'transfer customer'</span> ||
    newValLower === <span class="string">'your word here'</span>) {</pre>
                        </div>
                    </div>
                </div>

                <!-- Rough Quote Trigger -->
                <div class="trigger-card" data-keywords="rough quote ballpark estimate price">
                    <div class="trigger-header">
                        <div class="trigger-name">Rough quote</div>
                        <div class="trigger-icon">üí∞</div>
                    </div>
                    <div class="trigger-sheets">
                        <span class="sheet-badge leads">Leads</span>
                        <span class="sheet-badge fu">F/U</span>
                        <span class="sheet-badge awarded">Awarded</span>
                        <span class="sheet-badge heaven">Heaven</span>
                    </div>
                    <div class="trigger-description">
                        Creates rough quote draft/message with calculated price range based on job type
                    </div>
                    <div class="trigger-details">
                        <div class="output-section">
                            <div class="output-title">üì¨ Output</div>
                            <div class="output-content">
                                <strong>Email (if available):</strong> Draft created<br>
                                <strong>No email:</strong> Text message script in column B<br>
                                <strong>Pricing:</strong><br>
                                ‚Ä¢ Complete: $50-60/sqft<br>
                                ‚Ä¢ Re-cover: $105-115/yard (min 5' width)<br>
                                ‚Ä¢ Aluminum: $100-150/sqft
                            </div>
                        </div>
                        <div class="code-section">
                            <div class="code-header">
                                <span class="code-title">üìù How to Add Trigger Words</span>
                                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                            </div>
                            <pre class="code-block"><span class="comment">// File: Draft Creator.gs (around line 188)</span>
<span class="keyword">if</span> (newValLower === String(DRAFTS_V2.ROUGH_QUOTE_STAGE).toLowerCase() || 
    newValLower === <span class="string">'ballpark'</span> || 
    newValLower === <span class="string">'estimate'</span> ||
    newValLower === <span class="string">'your word here'</span>) {</pre>
                        </div>
                    </div>
                </div>

                <!-- COI Req Trigger -->
                <div class="trigger-card" data-keywords="coi insurance certificate w9 keyes">
                    <div class="trigger-header">
                        <div class="trigger-name">COI Req</div>
                        <div class="trigger-icon">üìÑ</div>
                    </div>
                    <div class="trigger-sheets">
                        <span class="sheet-badge fu">F/U</span>
                        <span class="sheet-badge awarded">Awarded</span>
                        <span class="sheet-badge heaven">Heaven</span>
                    </div>
                    <div class="trigger-description">
                        Creates COI request draft to Keyes team with W9 attachment (F/U, Awarded, Heaven sheets ONLY)
                    </div>
                    <div class="trigger-details">
                        <div class="output-section">
                            <div class="output-title">üì¨ Email Output</div>
                            <div class="output-content">
                                <strong>To:</strong> 5 Keyes team members<br>
                                <strong>Subject:</strong> COI Request: [Display Name]<br>
                                <strong>Attachment:</strong> W9 2025.pdf<br>
                                <strong>Body:</strong> COI request with address and customer contact<br>
                                <strong>Column B:</strong> Draft link created
                            </div>
                        </div>
                        <div class="code-section">
                            <div class="code-header">
                                <span class="code-title">üìù How to Add Trigger Words</span>
                                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                            </div>
                            <pre class="code-block"><span class="comment">// File: Draft Creator.gs (around line 195)</span>
<span class="keyword">if</span> (newValLower === String(DRAFTS_V2.COI_STAGE).toLowerCase() || 
    newValLower === <span class="string">'coi'</span> || 
    newValLower === <span class="string">'insurance'</span> ||
    newValLower === <span class="string">'your word here'</span>) {</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ROW MOVEMENTS TAB -->
        <div class="tab-content" id="moves">
            <div class="trigger-grid">
                <!-- Quote Sent Trigger -->
                <div class="trigger-card" data-keywords="quote sent quoted estimate sent email">
                    <div class="trigger-header">
                        <div class="trigger-name">Quote sent</div>
                        <div class="trigger-icon">üì§</div>
                    </div>
                    <div class="trigger-sheets">
                        <span class="sheet-badge leads">Leads</span>
                        <span class="sheet-badge awarded">Awarded</span>
                    </div>
                    <div class="trigger-description">
                        <strong>Current words:</strong> quote sent, quoted, estimate sent, sent<br>
                        Moves row to F/U sheet and searches for sent email to link in column B
                    </div>
                    <div class="trigger-details">
                        <div class="output-section">
                            <div class="output-title">üîÑ Actions</div>
                            <div class="output-content">
                                1. Moves row to <strong>F/U sheet</strong><br>
                                2. Searches for email: "Your awning quote from Walker Awning - [Display Name]"<br>
                                3. Falls back to "Awning Proposal" search<br>
                                4. Falls back to latest email from Gino<br>
                                5. <strong>Column B:</strong> Clickable link to email<br>
                                6. <strong>Column C:</strong> Automatically cleared
                            </div>
                        </div>
                        <div class="code-section">
                            <div class="code-header">
                                <span class="code-title">üìù How to Add Trigger Words (EASY!)</span>
                                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                            </div>
                            <pre class="code-block"><span class="comment">// File: Stage Automation.gs (around line 56)</span>
<span class="comment">// Find this line:</span>
quote_sent: [<span class="string">'quote sent'</span>, <span class="string">'quoted'</span>, <span class="string">'estimate sent'</span>, <span class="string">'sent'</span>],

<span class="comment">// Add your words to the array:</span>
quote_sent: [<span class="string">'quote sent'</span>, <span class="string">'quoted'</span>, <span class="string">'estimate sent'</span>, <span class="string">'sent'</span>, 
            <span class="string">'emailed'</span>, <span class="string">'proposal sent'</span>, <span class="string">'your word'</span>],</pre>
                        </div>
                    </div>
                </div>

                <!-- Awarded Trigger -->
                <div class="trigger-card" data-keywords="awarded won accepted approved deposit sold">
                    <div class="trigger-header">
                        <div class="trigger-name">Awarded</div>
                        <div class="trigger-icon">üéâ</div>
                    </div>
                    <div class="trigger-sheets">
                        <span class="sheet-badge leads">Leads</span>
                        <span class="sheet-badge fu">F/U</span>
                    </div>
                    <div class="trigger-description">
                        <strong>Current words:</strong> awarded, won, accepted, approved, waiting on deposit, deposit<br>
                        Moves row to Awarded sheet
                    </div>
                    <div class="trigger-details">
                        <div class="output-section">
                            <div class="output-title">üîÑ Actions</div>
                            <div class="output-content">
                                1. Moves row to <strong>Awarded sheet</strong><br>
                                2. <strong>Column C:</strong> Automatically cleared<br>
                                3. All formatting and links preserved
                            </div>
                        </div>
                        <div class="code-section">
                            <div class="code-header">
                                <span class="code-title">üìù How to Add Trigger Words</span>
                                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                            </div>
                            <pre class="code-block"><span class="comment">// File: Stage Automation.gs (around line 57)</span>
awarded: [<span class="string">'awarded'</span>, <span class="string">'won'</span>, <span class="string">'accepted'</span>, <span class="string">'approved'</span>, 
         <span class="string">'waiting on deposit'</span>, <span class="string">'deposit'</span>, <span class="string">'sold'</span>, <span class="string">'confirmed'</span>],</pre>
                        </div>
                    </div>
                </div>

                <!-- Archive Trigger -->
                <div class="trigger-card" data-keywords="archive archived closed done finished">
                    <div class="trigger-header">
                        <div class="trigger-name">Archive</div>
                        <div class="trigger-icon">üì¶</div>
                    </div>
                    <div class="trigger-sheets">
                        <span class="sheet-badge leads">Leads</span>
                        <span class="sheet-badge fu">F/U</span>
                        <span class="sheet-badge awarded">Awarded</span>
                    </div>
                    <div class="trigger-description">
                        <strong>Current words:</strong> archive, archived, closed<br>
                        Moves row to Purgatory sheet
                    </div>
                    <div class="trigger-details">
                        <div class="output-section">
                            <div class="output-title">üîÑ Actions</div>
                            <div class="output-content">
                                1. Moves row to <strong>Purgatory sheet</strong><br>
                                2. <strong>Column C:</strong> Automatically cleared<br>
                                3. All formatting preserved
                            </div>
                        </div>
                        <div class="code-section">
                            <div class="code-header">
                                <span class="code-title">üìù How to Add Trigger Words</span>
                                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                            </div>
                            <pre class="code-block"><span class="comment">// File: Stage Automation.gs (around line 58)</span>
archive: [<span class="string">'archive'</span>, <span class="string">'archived'</span>, <span class="string">'closed'</span>, <span class="string">'done'</span>, <span class="string">'finished'</span>],</pre>
                        </div>
                    </div>
                </div>

                <!-- Lost Trigger -->
                <div class="trigger-card" data-keywords="lost declined rejected cancelled no">
                    <div class="trigger-header">
                        <div class="trigger-name">Lost</div>
                        <div class="trigger-icon">‚ùå</div>
                    </div>
                    <div class="trigger-sheets">
                        <span class="sheet-badge leads">Leads</span>
                        <span class="sheet-badge fu">F/U</span>
                        <span class="sheet-badge awarded">Awarded</span>
                    </div>
                    <div class="trigger-description">
                        <strong>Current words:</strong> lost, declined, rejected, cancelled<br>
                        Moves row to Purgatory sheet
                    </div>
                    <div class="trigger-details">
                        <div class="output-section">
                            <div class="output-title">üîÑ Actions</div>
                            <div class="output-content">
                                1. Moves row to <strong>Purgatory sheet</strong><br>
                                2. <strong>Column C:</strong> Automatically cleared<br>
                                3. All formatting preserved
                            </div>
                        </div>
                        <div class="code-section">
                            <div class="code-header">
                                <span class="code-title">üìù How to Add Trigger Words</span>
                                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                            </div>
                            <pre class="code-block"><span class="comment">// File: Stage Automation.gs (around line 59)</span>
lost: [<span class="string">'lost'</span>, <span class="string">'declined'</span>, <span class="string">'rejected'</span>, <span class="string">'cancelled'</span>, <span class="string">'no go'</span>, <span class="string">'passed'</span>],</pre>
                        </div>
                    </div>
                </div>

                <!-- Heaven Trigger -->
                <div class="trigger-card" data-keywords="heaven installed complete completed done review">
                    <div class="trigger-header">
                        <div class="trigger-name">Heaven</div>
                        <div class="trigger-icon">‚ú®</div>
                    </div>
                    <div class="trigger-sheets">
                        <span class="sheet-badge leads">Leads</span>
                        <span class="sheet-badge fu">F/U</span>
                        <span class="sheet-badge awarded">Awarded</span>
                    </div>
                    <div class="trigger-description">
                        <strong>Current words:</strong> heaven, installed, complete, completed, done, pending review<br>
                        Moves row to Heaven sheet
                    </div>
                    <div class="trigger-details">
                        <div class="output-section">
                            <div class="output-title">üîÑ Actions</div>
                            <div class="output-content">
                                1. Moves row to <strong>Heaven sheet</strong><br>
                                2. <strong>Column C:</strong> Automatically cleared<br>
                                3. All formatting preserved
                            </div>
                        </div>
                        <div class="code-section">
                            <div class="code-header">
                                <span class="code-title">üìù How to Add Trigger Words</span>
                                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                            </div>
                            <pre class="code-block"><span class="comment">// File: Stage Automation.gs (around line 60)</span>
heaven: [<span class="string">'heaven'</span>, <span class="string">'installed'</span>, <span class="string">'complete'</span>, <span class="string">'completed'</span>, 
        <span class="string">'done'</span>, <span class="string">'pending review'</span>, <span class="string">'finished'</span>, <span class="string">'delivered'</span>],</pre>
                        </div>
                    </div>
                </div>

                <!-- Revise Trigger -->
                <div class="trigger-card" data-keywords="revise revision update change quote">
                    <div class="trigger-header">
                        <div class="trigger-name">Revise</div>
                        <div class="trigger-icon">üîÑ</div>
                    </div>
                    <div class="trigger-sheets">
                        <span class="sheet-badge fu">F/U</span>
                        <span class="sheet-badge awarded">Awarded</span>
                    </div>
                    <div class="trigger-description">
                        <strong>Current words:</strong> revise, revision, needs revision<br>
                        Moves row back to Leads sheet
                    </div>
                    <div class="trigger-details">
                        <div class="output-section">
                            <div class="output-title">üîÑ Actions</div>
                            <div class="output-content">
                                1. Moves row back to <strong>Leads sheet</strong><br>
                                2. <strong>Column C:</strong> Automatically cleared<br>
                                3. All formatting preserved
                            </div>
                        </div>
                        <div class="code-section">
                            <div class="code-header">
                                <span class="code-title">üìù How to Add Trigger Words</span>
                                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                            </div>
                            <pre class="code-block"><span class="comment">// File: Stage Automation.gs (around line 61)</span>
revise: [<span class="string">'revise'</span>, <span class="string">'revision'</span>, <span class="string">'needs revision'</span>, <span class="string">'update'</span>, <span class="string">'change quote'</span>],</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- SPECIAL ACTIONS TAB -->
        <div class="tab-content" id="special">
            <div class="trigger-grid">
                <!-- Schedule Trigger -->
                <div class="trigger-card" data-keywords="schedule sched calendar appointment tomorrow">
                    <div class="trigger-header">
                        <div class="trigger-name">2. Sched</div>
                        <div class="trigger-icon">üìÖ</div>
                    </div>
                    <div class="trigger-sheets">
                        <span class="sheet-badge leads">Leads ONLY</span>
                    </div>
                    <div class="trigger-description">
                        <strong>Current words:</strong> 2. sched, schedule, sched<br>
                        Creates all-day calendar event for tomorrow (does NOT move row)
                    </div>
                    <div class="trigger-details">
                        <div class="output-section">
                            <div class="output-title">üìÖ Calendar Event</div>
                            <div class="output-content">
                                <strong>Calendar:</strong> Appointments with Customers<br>
                                <strong>Type:</strong> All-day event<br>
                                <strong>Date:</strong> Tomorrow<br>
                                <strong>Title:</strong> Gino - [Customer Name]<br>
                                <strong>Location:</strong> [Project Address]<br>
                                <strong>Description:</strong><br>
                                Phone: [Phone Number]<br>
                                Address: [Project Address]<br><br>
                                <strong>Row stays in Leads (does NOT move)</strong>
                            </div>
                        </div>
                        <div class="code-section">
                            <div class="code-header">
                                <span class="code-title">üìù How to Add Trigger Words</span>
                                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                            </div>
                            <pre class="code-block"><span class="comment">// File: Stage Automation.gs (around line 62)</span>
schedule: [<span class="string">'2. sched'</span>, <span class="string">'schedule'</span>, <span class="string">'sched'</span>, <span class="string">'book'</span>, <span class="string">'calendar'</span>],</pre>
                        </div>
                    </div>
                </div>

                <!-- Print Folder Trigger (YOUR EXAMPLE!) -->
                <div class="trigger-card" data-keywords="print folder packet richard give images doc">
                    <div class="trigger-header">
                        <div class="trigger-name">Print Folder ‚≠ê</div>
                        <div class="trigger-icon">üñ®Ô∏è</div>
                    </div>
                    <div class="trigger-sheets">
                        <span class="sheet-badge fu">F/U</span>
                        <span class="sheet-badge awarded">Awarded</span>
                    </div>
                    <div class="trigger-description">
                        <strong>Current words:</strong> print folder, print packet, print<br>
                        Creates Google Doc with images from email (does NOT move row)<br>
                        <strong style="color: #667eea;">‚ú® Example: Add "give to richard" as trigger word!</strong>
                    </div>
                    <div class="trigger-details">
                        <div class="output-section">
                            <div class="output-title">üìÑ Document Created</div>
                            <div class="output-content">
                                1. Searches for email: "Proposal Review: [Display Name]"<br>
                                2. Extracts all image attachments<br>
                                3. Creates Google Doc: "Print Packet - [Display Name]"<br>
                                4. Saves to: Photos folder ‚Üí "Customer Folder - [Name] - [MM/YY]"<br>
                                5. <strong>Column B:</strong> Clickable link to Google Doc<br>
                                6. <strong>Row stays in current sheet (does NOT move)</strong>
                            </div>
                        </div>
                        <div class="code-section">
                            <div class="code-header">
                                <span class="code-title">üìù YOUR EXAMPLE - Add "give to richard"!</span>
                                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                            </div>
                            <pre class="code-block"><span class="comment">// File: Stage Automation.gs (around line 63)</span>
<span class="comment">// Find this line:</span>
print_folder: [<span class="string">'print folder'</span>, <span class="string">'print packet'</span>, <span class="string">'print'</span>]

<span class="comment">// Add "give to richard" (and any other words you want!):</span>
print_folder: [<span class="string">'print folder'</span>, <span class="string">'print packet'</span>, <span class="string">'print'</span>, 
              <span class="string">'give to richard'</span>, <span class="string">'richard'</span>, <span class="string">'your word'</span>]

<span class="comment">// That's it! Now typing "give to richard" will trigger Print Folder! ‚úÖ</span></pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- AUTO COLUMN TRIGGERS TAB -->
        <div class="tab-content" id="auto">
            <div class="trigger-grid">
                <!-- Display Name Trigger -->
                <div class="trigger-card" data-keywords="display name folder drive photos pics">
                    <div class="trigger-header">
                        <div class="trigger-name">Column F - Display Name</div>
                        <div class="trigger-icon">üìÅ</div>
                    </div>
                    <div class="trigger-sheets">
                        <span class="sheet-badge leads">Leads</span>
                        <span class="sheet-badge fu">F/U</span>
                        <span class="sheet-badge awarded">Awarded</span>
                    </div>
                    <div class="trigger-description">
                        Auto-triggers when you type/edit Display Name (Column F)<br>
                        Creates Drive folder and hyperlinks the cell
                    </div>
                    <div class="trigger-details">
                        <div class="output-section">
                            <div class="output-title">üîÑ Auto Actions</div>
                            <div class="output-content">
                                1. Creates folder in Photos folder (or finds existing)<br>
                                2. Folder name matches Display Name exactly<br>
                                3. <strong>Column F:</strong> Cell becomes clickable hyperlink to folder<br>
                                4. Works on Leads, F/U, and Awarded sheets
                            </div>
                        </div>
                        <div class="code-section">
                            <div class="code-header">
                                <span class="code-title">‚ÑπÔ∏è No Customization Needed</span>
                            </div>
                            <pre class="code-block"><span class="comment">// This trigger activates automatically when you edit column F</span>
<span class="comment">// No trigger words needed!</span>
<span class="comment">// To disable: Remove handleDisplayNameChange_ function call</span>
<span class="comment">// File: Stage Automation.gs (line ~144)</span></pre>
                        </div>
                    </div>
                </div>

                <!-- Email Trigger -->
                <div class="trigger-card" data-keywords="email gmail search customer">
                    <div class="trigger-header">
                        <div class="trigger-name">Column I - Email</div>
                        <div class="trigger-icon">üìß</div>
                    </div>
                    <div class="trigger-sheets">
                        <span class="sheet-badge leads">Leads</span>
                        <span class="sheet-badge fu">F/U</span>
                        <span class="sheet-badge awarded">Awarded</span>
                    </div>
                    <div class="trigger-description">
                        Auto-triggers when you type/edit Email (Column I)<br>
                        Creates Gmail search link for that email address
                    </div>
                    <div class="trigger-details">
                        <div class="output-section">
                            <div class="output-title">üîÑ Auto Actions</div>
                            <div class="output-content">
                                1. Encodes email address for URL<br>
                                2. Creates Gmail search URL<br>
                                3. <strong>Column I:</strong> Cell becomes clickable link to Gmail search<br>
                                4. Works on Leads, F/U, and Awarded sheets
                            </div>
                        </div>
                        <div class="code-section">
                            <div class="code-header">
                                <span class="code-title">‚ÑπÔ∏è No Customization Needed</span>
                            </div>
                            <pre class="code-block"><span class="comment">// This trigger activates automatically when you edit column I</span>
<span class="comment">// No trigger words needed!</span>
<span class="comment">// Format: https://mail.google.com/mail/u/0/#search/[email]</span>
<span class="comment">// File: Stage Automation.gs (line ~181)</span></pre>
                        </div>
                    </div>
                </div>

                <!-- Address Trigger -->
                <div class="trigger-card" data-keywords="address maps directions earth location">
                    <div class="trigger-header">
                        <div class="trigger-name">Column J - Address</div>
                        <div class="trigger-icon">üó∫Ô∏è</div>
                    </div>
                    <div class="trigger-sheets">
                        <span class="sheet-badge leads">Leads</span>
                        <span class="sheet-badge fu">F/U</span>
                        <span class="sheet-badge awarded">Awarded</span>
                    </div>
                    <div class="trigger-description">
                        Auto-triggers when you type/edit Address (Column J)<br>
                        Creates Maps directions link AND Google Earth link (Column Q)
                    </div>
                    <div class="trigger-details">
                        <div class="output-section">
                            <div class="output-title">üîÑ Auto Actions</div>
                            <div class="output-content">
                                1. Creates Google Maps directions from shop to address<br>
                                2. <strong>Column J:</strong> Cell becomes clickable link to Maps<br>
                                3. Geocodes address to get coordinates<br>
                                4. <strong>Column Q:</strong> Auto-creates Google Earth link<br>
                                5. Shop: Walker Awning, 5190 NW 10th Terrace, Fort Lauderdale, FL
                            </div>
                        </div>
                        <div class="code-section">
                            <div class="code-header">
                                <span class="code-title">‚ÑπÔ∏è No Customization Needed</span>
                            </div>
                            <pre class="code-block"><span class="comment">// This trigger activates automatically when you edit column J</span>
<span class="comment">// Triggers TWO actions:</span>
<span class="comment">// 1. Maps directions link in column J</span>
<span class="comment">// 2. Google Earth link auto-created in column Q</span>
<span class="comment">// File: Stage Automation.gs (line ~213)</span></pre>
                        </div>
                    </div>
                </div>

                <!-- Job Description Trigger -->
                <div class="trigger-card" data-keywords="job description auto formula dimensions fabric">
                    <div class="trigger-header">
                        <div class="trigger-name">Column M - Job Description</div>
                        <div class="trigger-icon">üìù</div>
                    </div>
                    <div class="trigger-sheets">
                        <span class="sheet-badge leads">Leads ONLY</span>
                    </div>
                    <div class="trigger-description">
                        Auto-triggers when Job Type (R), Length (T), Width (U), Valance (Z), or Fabric (AB) changes<br>
                        Generates formatted job description
                    </div>
                    <div class="trigger-details">
                        <div class="output-section">
                            <div class="output-title">üîÑ Auto Actions</div>
                            <div class="output-content">
                                <strong>For Re-cover jobs:</strong><br>
                                ‚Ä¢ "Replace existing awning fabric."<br>
                                ‚Ä¢ Dimensions, Valance Style, Fabric<br>
                                ‚Ä¢ Fabric-specific notes (Sunbrella/Vinyl)<br><br>
                                <strong>For Complete jobs:</strong><br>
                                ‚Ä¢ "Design, fabricate and Install..."<br>
                                ‚Ä¢ Dimensions, Fabric, Color choice<br>
                                ‚Ä¢ Valance, Metal, Painted frames<br>
                                ‚Ä¢ Fabric-specific notes
                            </div>
                        </div>
                        <div class="code-section">
                            <div class="code-header">
                                <span class="code-title">‚ÑπÔ∏è No Customization Needed</span>
                            </div>
                            <pre class="code-block"><span class="comment">// Auto-triggers when these columns change:</span>
<span class="comment">// ‚Ä¢ Column R (Job Type)</span>
<span class="comment">// ‚Ä¢ Column T (Length)</span>
<span class="comment">// ‚Ä¢ Column U (Width)</span>
<span class="comment">// ‚Ä¢ Column Z (Valance)</span>
<span class="comment">// ‚Ä¢ Column AB (Fabric)</span>
<span class="comment">// File: Stage Automation.gs (line ~157)</span></pre>
                        </div>
                    </div>
                </div>

                <!-- QB URL Trigger -->
                <div class="trigger-card" data-keywords="quickbooks qb url quote estimate">
                    <div class="trigger-header">
                        <div class="trigger-name">Column P - QB URL</div>
                        <div class="trigger-icon">üíº</div>
                    </div>
                    <div class="trigger-sheets">
                        <span class="sheet-badge leads">Leads</span>
                        <span class="sheet-badge fu">F/U</span>
                        <span class="sheet-badge awarded">Awarded</span>
                        <span class="sheet-badge heaven">Heaven</span>
                        <span class="sheet-badge">Purgatory</span>
                    </div>
                    <div class="trigger-description">
                        Auto-triggers when you paste QuickBooks URL (Column P)<br>
                        Formats cell as "QB" hyperlink (works on ALL sheets)
                    </div>
                    <div class="trigger-details">
                        <div class="output-section">
                            <div class="output-title">üîÑ Auto Actions</div>
                            <div class="output-content">
                                1. Extracts URL from pasted content<br>
                                2. <strong>Column P:</strong> Shows "QB" as clickable hyperlink<br>
                                3. Works on: Leads, F/U, Awarded, Heaven, Purgatory<br>
                                4. Supports: formula, rich text, or plain URL
                            </div>
                        </div>
                        <div class="code-section">
                            <div class="code-header">
                                <span class="code-title">‚ÑπÔ∏è No Customization Needed</span>
                            </div>
                            <pre class="code-block"><span class="comment">// This trigger activates automatically on ALL sheets</span>
<span class="comment">// when you edit column P with a URL</span>
<span class="comment">// File: Stage Automation.gs (line ~269)</span></pre>
                        </div>
                    </div>
                </div>

                <!-- Earth Link Trigger -->
                <div class="trigger-card" data-keywords="earth google coordinates geocode column q">
                    <div class="trigger-header">
                        <div class="trigger-name">Column Q - Earth Link</div>
                        <div class="trigger-icon">üåç</div>
                    </div>
                    <div class="trigger-sheets">
                        <span class="sheet-badge leads">Leads</span>
                        <span class="sheet-badge fu">F/U</span>
                        <span class="sheet-badge awarded">Awarded</span>
                    </div>
                    <div class="trigger-description">
                        Auto-triggers when Address (Column J) changes<br>
                        Geocodes address and creates Google Earth link with coordinates
                    </div>
                    <div class="trigger-details">
                        <div class="output-section">
                            <div class="output-title">üîÑ Auto Actions</div>
                            <div class="output-content">
                                1. Geocodes address using Google Maps API<br>
                                2. Gets latitude/longitude coordinates<br>
                                3. <strong>Column Q:</strong> "Earth" as clickable link<br>
                                4. Format: https://earth.google.com/web/@[lat],[lng],10a,2574d,1y,0h,0t,0r<br>
                                5. Falls back to search URL if geocoding fails
                            </div>
                        </div>
                        <div class="code-section">
                            <div class="code-header">
                                <span class="code-title">‚ÑπÔ∏è No Customization Needed</span>
                            </div>
                            <pre class="code-block"><span class="comment">// This is automatically triggered by Column J (Address) edits</span>
<span class="comment">// You never edit Column Q directly - it's auto-generated!</span>
<span class="comment">// File: Stage Automation.gs (line ~244)</span></pre>
                        </div>
                    </div>
                </div>

                <!-- Split CSV Trigger -->
                <div class="trigger-card" data-keywords="split csv comma column a delimiter">
                    <div class="trigger-header">
                        <div class="trigger-name">Column A - Split CSV</div>
                        <div class="trigger-icon">‚úÇÔ∏è</div>
                    </div>
                    <div class="trigger-sheets">
                        <span class="sheet-badge leads">Leads ONLY</span>
                    </div>
                    <div class="trigger-description">
                        Auto-triggers when Column A contains comma-separated values<br>
                        Automatically splits values across columns
                    </div>
                    <div class="trigger-details">
                        <div class="output-section">
                            <div class="output-title">üîÑ Auto Actions</div>
                            <div class="output-content">
                                1. Detects commas in Column A<br>
                                2. Automatically splits values across columns<br>
                                3. Uses comma as delimiter<br>
                                4. <strong>Only active on Leads sheet</strong><br><br>
                                Example: "John, Doe, 123 Main St"<br>
                                Splits to: A="John" | B="Doe" | C="123 Main St"
                            </div>
                        </div>
                        <div class="code-section">
                            <div class="code-header">
                                <span class="code-title">‚ÑπÔ∏è No Customization Needed</span>
                            </div>
                            <pre class="code-block"><span class="comment">// Auto-triggers when Column A contains commas</span>
<span class="comment">// Only works on Leads sheet</span>
<span class="comment">// File: Stage Automation.gs (line ~131)</span></pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- OTHER AUTOMATIONS TAB -->
        <div class="tab-content" id="other">
            <div class="trigger-grid">
                <!-- Mileage Log -->
                <div class="trigger-card" data-keywords="mileage log calendar sync distance">
                    <div class="trigger-header">
                        <div class="trigger-name">Mileage Log Sync</div>
                        <div class="trigger-icon">üöó</div>
                    </div>
                    <div class="trigger-sheets">
                        <span class="sheet-badge">Time-based: 6 AM daily</span>
                    </div>
                    <div class="trigger-description">
                        Automatically syncs calendar events to "2 Mile log" sheet every morning at 6 AM
                    </div>
                    <div class="trigger-details">
                        <div class="output-section">
                            <div class="output-title">üîÑ Daily Actions</div>
                            <div class="output-content">
                                ‚Ä¢ Reads from "Appointments with Customers" calendar<br>
                                ‚Ä¢ Fills gaps between first and last logged entry<br>
                                ‚Ä¢ Catches up from last entry to today<br>
                                ‚Ä¢ Skips office address events<br>
                                ‚Ä¢ Creates clickable Maps and Calendar links<br>
                                ‚Ä¢ Calculates distances between appointments<br>
                                ‚Ä¢ Adds ordinal numbers (1st, 2nd, 3rd trip)<br>
                                ‚Ä¢ Auto-calculates mileage reimbursement
                            </div>
                        </div>
                        <div class="code-section">
                            <div class="code-header">
                                <span class="code-title">‚öôÔ∏è Manual Controls</span>
                            </div>
                            <pre class="code-block"><span class="comment">// Menu: Setup (Mileage) ‚Üí Install Mileage Sync Trigger</span>
<span class="comment">// File: Miles Log.gs</span>

<span class="comment">// To run manually:</span>
<span class="function">runMileageSync_</span>()

<span class="comment">// To populate all historical events:</span>
<span class="function">populateAllMileage_</span>()</pre>
                        </div>
                    </div>
                </div>

                <!-- Lean-to Ruby Generator -->
                <div class="trigger-card" data-keywords="lean-to ruby sketchup generator script">
                    <div class="trigger-header">
                        <div class="trigger-name">Lean-to Ruby Generator</div>
                        <div class="trigger-icon">üìê</div>
                    </div>
                    <div class="trigger-sheets">
                        <span class="sheet-badge leads">Leads ONLY</span>
                    </div>
                    <div class="trigger-description">
                        Auto-generates SketchUp Ruby script when Type (AA) contains "Lean-to" or "Sloped L"
                    </div>
                    <div class="trigger-details">
                        <div class="output-section">
                            <div class="output-title">üîÑ Auto Actions</div>
                            <div class="output-content">
                                <strong>Triggers when columns T-AD edited AND Type (AA) = "Lean-to" or "Sloped L"</strong><br><br>
                                1. Reads dimensions: T, U, V, X, Y, AB, AD<br>
                                2. Generates SketchUp Ruby (.rb) script file<br>
                                3. Saves to Drive folder "SketchUp Ruby Exports"<br>
                                4. <strong>Column S:</strong> Shows "Ruby (.rb)" as clickable link<br><br>
                                Uses: Length (T), Width (U), Front Bar (V), Wing Height (X),<br>
                                # Wings (Y), Fabric (AB), Posts (AD)
                            </div>
                        </div>
                        <div class="code-section">
                            <div class="code-header">
                                <span class="code-title">‚öôÔ∏è Manual Controls</span>
                            </div>
                            <pre class="code-block"><span class="comment">// Menu: Setup (Ruby) ‚Üí Generate Ruby for Current Row</span>
<span class="comment">// File: Lean-to generator.gs</span>

<span class="comment">// To generate for all Lean-to rows:</span>
<span class="function">generateRubyForAllLeantoRows_</span>()</pre>
                        </div>
                    </div>
                </div>

                <!-- QuickBooks Integration -->
                <div class="trigger-card" data-keywords="quickbooks invoice estimate convert awarded">
                    <div class="trigger-header">
                        <div class="trigger-name">QB Estimate ‚Üí Invoice</div>
                        <div class="trigger-icon">üíº</div>
                    </div>
                    <div class="trigger-sheets">
                        <span class="sheet-badge awarded">Awarded Sheet</span>
                    </div>
                    <div class="trigger-description">
                        Manually converts QuickBooks estimate to invoice for selected row in Awarded sheet
                    </div>
                    <div class="trigger-details">
                        <div class="output-section">
                            <div class="output-title">üîÑ Manual Actions</div>
                            <div class="output-content">
                                <strong>Requirements:</strong><br>
                                ‚Ä¢ Row must be in Awarded sheet<br>
                                ‚Ä¢ Column P must contain QB estimate link<br><br>
                                <strong>Output:</strong><br>
                                ‚Ä¢ Creates invoice in QuickBooks<br>
                                ‚Ä¢ <strong>Column N:</strong> Invoice link with $amount as display text<br>
                                ‚Ä¢ Optionally sends invoice to customer email
                            </div>
                        </div>
                        <div class="code-section">
                            <div class="code-header">
                                <span class="code-title">‚öôÔ∏è How to Use</span>
                            </div>
                            <pre class="code-block"><span class="comment">// Menu: Setup (QuickBooks) ‚Üí Convert Estimate to Invoice</span>
<span class="comment">// File: QBO Estimates.gs</span>

<span class="comment">// 1. Select row in Awarded sheet</span>
<span class="comment">// 2. Click menu item</span>
<span class="comment">// 3. Invoice created and linked in Column N</span>

<span class="comment">// To process ALL awarded estimates:</span>
<span class="function">processAllAwardedEstimates</span>()</pre>
                        </div>
                    </div>
                </div>

                <!-- Daily Folder Check -->
                <div class="trigger-card" data-keywords="folder check empty photos drive maintenance">
                    <div class="trigger-header">
                        <div class="trigger-name">Daily Folder Check</div>
                        <div class="trigger-icon">üîç</div>
                    </div>
                    <div class="trigger-sheets">
                        <span class="sheet-badge">Time-based: 7 AM daily</span>
                    </div>
                    <div class="trigger-description">
                        Checks for empty folders in Photos directory every morning at 7 AM
                    </div>
                    <div class="trigger-details">
                        <div class="output-section">
                            <div class="output-title">üîÑ Daily Actions</div>
                            <div class="output-content">
                                1. Scans Photos folder for empty subfolders<br>
                                2. Logs empty folders (if logging enabled)<br>
                                3. Helps maintain folder organization<br>
                                4. Can be run manually anytime
                            </div>
                        </div>
                        <div class="code-section">
                            <div class="code-header">
                                <span class="code-title">‚öôÔ∏è Manual Controls</span>
                            </div>
                            <pre class="code-block"><span class="comment">// Menu: Setup (Move) ‚Üí Check Empty Folders Now</span>
<span class="comment">// File: Stage Automation.gs</span>

<span class="function">checkEmptyFoldersNow_</span>()

<span class="comment">// To install daily check:</span>
<span class="function">installDailyFolderCheckTrigger_</span>()</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="no-results" id="noResults" style="display: none;">
            <div style="font-size: 3em; margin-bottom: 20px;">üîç</div>
            <div>No triggers found matching your search.</div>
            <div style="margin-top: 10px; color: #ccc;">Try different keywords or clear the search.</div>
        </div>
    </div>

    <script>
        // Load triggers from JSON (for GitHub version)
        let triggersData = null;
        
        async function loadTriggersFromGitHub() {
            try {
                const response = await fetch('triggers.json');
                if (response.ok) {
                    triggersData = await response.json();
                    updateStatsFromData();
                    console.log('‚úÖ Loaded triggers from GitHub:', triggersData);
                }
            } catch (error) {
                console.log('‚ÑπÔ∏è Running in standalone mode (not GitHub)');
            }
        }
        
        function updateStatsFromData() {
            if (!triggersData) return;
            
            const draftCount = triggersData.draftCreator?.length || 0;
            const moveCount = triggersData.stageMoves?.length || 0;
            const autoCount = triggersData.autoColumns?.length || 0;
            const totalCount = triggersData.metadata?.totalTriggers || 0;
            
            document.getElementById('draftCount').textContent = draftCount;
            document.getElementById('moveCount').textContent = moveCount;
            document.getElementById('autoCount').textContent = autoCount;
            document.getElementById('totalCount').textContent = totalCount;
            
            // Show last updated time if available
            if (triggersData.metadata?.lastUpdated) {
                const date = new Date(triggersData.metadata.lastUpdated);
                const timeAgo = getTimeAgo(date);
                const header = document.querySelector('header');
                const updateBadge = document.createElement('div');
                updateBadge.style.cssText = 'margin-top: 15px; padding: 10px; background: #e8f5e9; border-radius: 8px; color: #2e7d32; font-size: 0.9em;';
                updateBadge.innerHTML = `<strong>üîÑ Auto-synced from GitHub</strong> ‚Ä¢ Last updated: ${timeAgo}`;
                header.appendChild(updateBadge);
            }
        }
        
        function getTimeAgo(date) {
            const seconds = Math.floor((new Date() - date) / 1000);
            const intervals = {
                year: 31536000,
                month: 2592000,
                week: 604800,
                day: 86400,
                hour: 3600,
                minute: 60
            };
            
            for (const [unit, secondsInUnit] of Object.entries(intervals)) {
                const interval = Math.floor(seconds / secondsInUnit);
                if (interval >= 1) {
                    return `${interval} ${unit}${interval !== 1 ? 's' : ''} ago`;
                }
            }
            return 'just now';
        }
        
        // Initialize
        loadTriggersFromGitHub();
        
        // Tab switching
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                // Remove active from all tabs and content
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                // Add active to clicked tab and corresponding content
                tab.classList.add('active');
                const tabName = tab.getAttribute('data-tab');
                document.getElementById(tabName).classList.add('active');
                
                // Reset search when switching tabs
                document.getElementById('searchInput').value = '';
                filterTriggers('');
            });
        });

        // Card expansion
        document.querySelectorAll('.trigger-card').forEach(card => {
            card.addEventListener('click', (e) => {
                // Don't expand if clicking copy button
                if (e.target.classList.contains('copy-btn')) return;
                
                card.classList.toggle('expanded');
            });
        });

        // Copy code functionality
        function copyCode(button) {
            const codeBlock = button.closest('.code-section').querySelector('.code-block');
            const text = codeBlock.textContent;
            
            navigator.clipboard.writeText(text).then(() => {
                const originalText = button.textContent;
                button.textContent = 'Copied!';
                button.style.background = '#4CAF50';
                
                setTimeout(() => {
                    button.textContent = originalText;
                    button.style.background = '#667eea';
                }, 2000);
            });
        }

        // Search functionality
        const searchInput = document.getElementById('searchInput');
        searchInput.addEventListener('input', (e) => {
            filterTriggers(e.target.value.toLowerCase());
        });

        function filterTriggers(searchTerm) {
            const allCards = document.querySelectorAll('.trigger-card');
            let visibleCount = 0;
            
            allCards.forEach(card => {
                const keywords = card.getAttribute('data-keywords') || '';
                const triggerName = card.querySelector('.trigger-name').textContent.toLowerCase();
                const description = card.querySelector('.trigger-description').textContent.toLowerCase();
                
                const matches = !searchTerm || 
                    keywords.includes(searchTerm) || 
                    triggerName.includes(searchTerm) || 
                    description.includes(searchTerm);
                
                if (matches) {
                    card.classList.remove('hidden');
                    visibleCount++;
                } else {
                    card.classList.add('hidden');
                }
            });
            
            // Show/hide no results message
            const noResults = document.getElementById('noResults');
            if (visibleCount === 0 && searchTerm) {
                noResults.style.display = 'block';
            } else {
                noResults.style.display = 'none';
            }
        }

        // Expand icon animation helper
        document.querySelectorAll('.trigger-card').forEach(card => {
            const icon = document.createElement('span');
            icon.className = 'expand-icon';
            icon.textContent = '‚ñº';
            icon.style.cssText = 'font-size: 0.8em; color: #999;';
            card.querySelector('.trigger-header').appendChild(icon);
        });
    </script>
</body>
</html>
