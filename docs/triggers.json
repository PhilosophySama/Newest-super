{
  "metadata": {
    "lastUpdated": "2026-01-16T13:43:33.167Z",
    "repoUrl": "https://github.com/PhilosophySama/Newest-super",
    "version": "2.0-complete",
    "scanType": "comprehensive",
    "totalTriggers": 20
  },
  "stats": {
    "totalFiles": 10,
    "totalFunctions": 144,
    "totalTriggers": 20,
    "totalLines": 6762,
    "publicFunctions": 49,
    "helperFunctions": 131,
    "avgFunctionsPerFile": 14,
    "avgLinesPerFile": 676
  },
  "files": [
    {
      "path": "Draft Creator.gs",
      "filename": "Draft Creator.gs",
      "purpose": "Draft Creator.gs Version: 1/16 9am EST by Claude Sonnet 4.5 PURPOSE",
      "version": "1/16 9am EST by Claude Sonnet 4.5",
      "functions": [
        {
          "name": "installTriggerDrafts_V2",
          "line": 188,
          "description": null,
          "isPublic": true,
          "isHelper": true
        },
        {
          "name": "handleEditDraft_V2",
          "line": 207,
          "description": null,
          "isPublic": true,
          "isHelper": true
        },
        {
          "name": "v2_searchAndLinkEmail_",
          "line": 289,
          "description": "Search Gmail for existing emails/drafts and link in column B",
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "v2_createCustomerDraft_",
          "line": 379,
          "description": "Create customer follow-up draft when \"Email customer\" is selected",
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "v2_createHandoffDraft_",
          "line": 484,
          "description": "Create customer handoff draft when \"Cust Handoff\" is selected",
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "v2_createCustomerInfoDraft_",
          "line": 560,
          "description": "Create customer info request draft when \"Customer Info\" is selected",
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "v2_createCOIDraft_",
          "line": 777,
          "description": "Create COI request draft when \"COI Req\" is selected",
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "v2_createRoughQuote_",
          "line": 928,
          "description": "Create rough quote draft/message when \"Rough quote\" is selected",
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "createDraftsForAllRows_V2",
          "line": 1041,
          "description": null,
          "isPublic": true,
          "isHelper": true
        },
        {
          "name": "v2_createDraftForRow_",
          "line": 1088,
          "description": "Row → Draft creation ========================= */",
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "v2_exportRecoverRangeAsHtml_",
          "line": 1214,
          "description": "HTML export of Re-cover range (FIXED VERSION) Uses proper A1 notation in the API call",
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "v2_sheetsDataToHtml_",
          "line": 1256,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "v2_buildHtmlBody_",
          "line": 1390,
          "description": "Email body builders ================ */",
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "v2_buildPlainBody_",
          "line": 1449,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "d_extractUrlFromCell_",
          "line": 1461,
          "description": "Helpers ===================== */",
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "d_looksLikeUrl_",
          "line": 1511,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "d_safeString_",
          "line": 1512,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "d_htmlEscape_",
          "line": 1513,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "d_colLetterToIndex_",
          "line": 1515,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "v2_getSpreadsheet_",
          "line": 1521,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "d_writeB_",
          "line": 1528,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "d_withRetry_",
          "line": 1539,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "d_specificErrorMessage_",
          "line": 1555,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "d_shortErr_",
          "line": 1562,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "v2_validateConfig_",
          "line": 1564,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "d_isValidEmail_",
          "line": 1571,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "d_firstLinkInRichText_",
          "line": 1573,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "d_isGmailDraftUrl_",
          "line": 1585,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "d_templateSafe_",
          "line": 1589,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "d_timestamp_",
          "line": 1601,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "d_safeLogErrorToSheet_",
          "line": 1607,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "d_generateRouteMapUrl_",
          "line": 1623,
          "description": "Generate Google Maps Static API URL for route image with distance/time data Returns object: { mapUrl, distance, duration } or null on failure",
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "d_generateSimpleMapUrl_",
          "line": 1691,
          "description": "Fallback: Generate simple map URL with just markers (no route line)",
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "testMapsApiConnection",
          "line": 1705,
          "description": "Test function - run this to verify Maps API works",
          "isPublic": true,
          "isHelper": false
        },
        {
          "name": "d_generateSatelliteMapUrl_",
          "line": 1722,
          "description": "Generate Google Maps Static API satellite view URL for a location Returns the satellite image URL or null on failure",
          "isPublic": false,
          "isHelper": true
        }
      ],
      "triggers": [
        {
          "type": "draft_stage",
          "key": "TARGET_STAGE",
          "words": [
            "qDraft"
          ],
          "primary": "qDraft"
        },
        {
          "type": "draft_stage",
          "key": "LIZ_STAGE",
          "words": [
            "Liz"
          ],
          "primary": "Liz"
        },
        {
          "type": "draft_stage",
          "key": "CUSTOMER_STAGE",
          "words": [
            "Email customer"
          ],
          "primary": "Email customer"
        },
        {
          "type": "draft_stage",
          "key": "HANDOFF_STAGE",
          "words": [
            "Cust Handoff"
          ],
          "primary": "Cust Handoff"
        },
        {
          "type": "draft_stage",
          "key": "ROUGH_QUOTE_STAGE",
          "words": [
            "Rough quote"
          ],
          "primary": "Rough quote"
        },
        {
          "type": "draft_stage",
          "key": "COI_STAGE",
          "words": [
            "COI Req"
          ],
          "primary": "COI Req"
        }
      ],
      "dependencies": [
        "v2_validateConfig_",
        "v2_getSpreadsheet_",
        "d_colLetterToIndex_",
        "v2_searchAndLinkEmail_",
        "v2_createCustomerDraft_",
        "v2_createHandoffDraft_",
        "v2_createRoughQuote_",
        "v2_createCustomerInfoDraft_",
        "v2_createCOIDraft_",
        "v2_createDraftForRow_",
        "d_shortErr_",
        "d_safeString_",
        "d_extractUrlFromCell_",
        "d_isValidEmail_",
        "d_templateSafe_",
        "d_htmlEscape_",
        "d_withRetry_",
        "d_specificErrorMessage_",
        "d_firstLinkInRichText_",
        "d_isGmailDraftUrl_",
        "d_generateRouteMapUrl_",
        "d_generateSatelliteMapUrl_",
        "v2_exportRecoverRangeAsHtml_",
        "v2_buildHtmlBody_",
        "v2_buildPlainBody_",
        "d_writeB_",
        "v2_sheetsDataToHtml_",
        "d_looksLikeUrl_",
        "d_timestamp_",
        "d_safeLogErrorToSheet_",
        "d_generateSimpleMapUrl_",
        "DRAFTS_V2"
      ],
      "lines": 1744,
      "size": 69799
    },
    {
      "path": "Email Reader.gs",
      "filename": "Email Reader.gs",
      "purpose": "EMAIL READER AUTOMATION - UNIFIED LEAD INGESTION Version: 1/16 9am EST by Claude Sonnet 4.5 FEATURES:",
      "version": "1/16 9am EST by Claude Sonnet 4.5",
      "functions": [
        {
          "name": "er_buildCSV_",
          "line": 117,
          "description": "Build a 29-column CSV string from extracted data Columns: A-AC (Date through Awning Type)",
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "er_diagnosticCheck",
          "line": 151,
          "description": "DIAGNOSTIC FUNCTION - Quick check, no popup",
          "isPublic": true,
          "isHelper": true
        },
        {
          "name": "er_isRubyEmail_",
          "line": 177,
          "description": "Determine if email is from Ruby",
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "er_processEmail_",
          "line": 186,
          "description": "Process a single email - writes CSV to column A Stage Automation will split it across columns",
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "er_extractWithPatterns_",
          "line": 329,
          "description": "Extract data using pattern matching",
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "er_extractStructured_",
          "line": 434,
          "description": "Extract data using structured key:value parsing",
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "er_log_",
          "line": 508,
          "description": "Logging function",
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "er_installTrigger",
          "line": 521,
          "description": "Install trigger - runs every 15 minutes for BOTH Ruby and \"Add lead\"",
          "isPublic": true,
          "isHelper": true
        },
        {
          "name": "er_removeTrigger",
          "line": 539,
          "description": "Remove trigger",
          "isPublic": true,
          "isHelper": true
        },
        {
          "name": "er_processNewEmails",
          "line": 552,
          "description": "MAIN: Process ALL pending emails (Ruby + Add lead) - runs automatically",
          "isPublic": true,
          "isHelper": true
        },
        {
          "name": "er_processAddLeadEmails",
          "line": 625,
          "description": "Process only \"Add lead\" emails manually",
          "isPublic": true,
          "isHelper": true
        },
        {
          "name": "er_testProcessing",
          "line": 667,
          "description": "Test processing - no popup, just runs and shows toast",
          "isPublic": true,
          "isHelper": true
        }
      ],
      "triggers": [],
      "dependencies": [
        "er_buildCSV_",
        "er_log_",
        "er_isRubyEmail_",
        "er_processEmail_",
        "er_extractWithPatterns_",
        "er_extractStructured_",
        "Defines: EMAIL_READER_CONFIG"
      ],
      "lines": 719,
      "size": 21959
    },
    {
      "path": "Lead follow up.gs.gs",
      "filename": "Lead follow up.gs.gs",
      "purpose": "Lead Follow up.gs Version: 1/16 9am EST by Claude Sonnet 4.5 PURPOSE",
      "version": "1/16 9am EST by Claude Sonnet 4.5",
      "functions": [
        {
          "name": "installTriggerDrafts_FU",
          "line": 35,
          "description": null,
          "isPublic": true,
          "isHelper": true
        },
        {
          "name": "handleEditDraft_FU",
          "line": 48,
          "description": null,
          "isPublic": true,
          "isHelper": true
        },
        {
          "name": "createDraftsForAllRows_FU",
          "line": 80,
          "description": null,
          "isPublic": true,
          "isHelper": true
        },
        {
          "name": "fu_createDraftForRow_",
          "line": 127,
          "description": "Row → Draft creation ========================= */",
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "fu_safeString_",
          "line": 173,
          "description": "Helpers ===================== */",
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "fu_colLetterToIndex_",
          "line": 174,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "fu_getSpreadsheet_",
          "line": 179,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "fu_writeB_",
          "line": 185,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "fu_firstLinkInRichText_",
          "line": 195,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "fu_isGmailDraftUrl_",
          "line": 206,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "fu_shortErr_",
          "line": 210,
          "description": null,
          "isPublic": false,
          "isHelper": true
        }
      ],
      "triggers": [],
      "dependencies": [
        "fu_getSpreadsheet_",
        "fu_colLetterToIndex_",
        "fu_firstLinkInRichText_",
        "fu_isGmailDraftUrl_",
        "fu_createDraftForRow_",
        "fu_shortErr_",
        "fu_safeString_",
        "fu_writeB_"
      ],
      "lines": 212,
      "size": 7741
    },
    {
      "path": "Lean-to generator.gs",
      "filename": "Lean-to generator.gs",
      "purpose": "LEAN-TO & A-FRAME RUBY (Exact) — Drive File Export Version: 1/16 9am EST by Claude Sonnet 4.5 Triggers on edits to Leads!T:AD (cols 20–30) when AA contains:",
      "version": "1/16 9am EST by Claude Sonnet 4.5",
      "functions": [
        {
          "name": "handleEditAwningRuby_",
          "line": 29,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "r_buildRubyFromLeanToTemplate_",
          "line": 144,
          "description": "Replace ONLY the parameter literals in the Lean-to Ruby template. Every other character (including spacing and comments) is preserved verbatim.",
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "r_buildRubyFromAFrameTemplate_",
          "line": 196,
          "description": "Replace ONLY the parameter literals in the A-Frame Ruby template. Every other character (including spacing and comments) is preserved verbatim.",
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "r_getLeanToRubyTemplate_",
          "line": 249,
          "description": "LEAN-TO RUBY TEMPLATE — DO NOT CHANGE ANYTHING HERE. We substitute only the parameter values via r_buildRubyFromLeanToTemplate_().",
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "r_getAFrameRubyTemplate_",
          "line": 444,
          "description": "A-FRAME RUBY TEMPLATE — DO NOT CHANGE ANYTHING HERE. We substitute only the parameter values via r_buildRubyFromAFrameTemplate_().",
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "r_writeRubyToDrive_",
          "line": 698,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "r_getRubyExportFolder_",
          "line": 716,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "installTriggerAwningRuby_",
          "line": 731,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "handleEditLeanToRuby_",
          "line": 743,
          "description": "Backward compatibility wrappers for old function names",
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "installTriggerLeanToRuby_",
          "line": 747,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "r_getRubyExactTemplate",
          "line": 751,
          "description": null,
          "isPublic": true,
          "isHelper": true
        },
        {
          "name": "copyRubyForSelectedRow_",
          "line": 758,
          "description": "Copy Ruby code for the selected row to clipboard via dialog Version# [12/29-10:45AM EST] by Claude Opus 4.1",
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "copyCode",
          "line": 885,
          "description": null,
          "isPublic": true,
          "isHelper": false
        }
      ],
      "triggers": [],
      "dependencies": [
        "handleEditAwningRuby_",
        "r_buildRubyFromLeanToTemplate_",
        "r_buildRubyFromAFrameTemplate_",
        "r_writeRubyToDrive_",
        "r_getLeanToRubyTemplate_",
        "r_getAFrameRubyTemplate_",
        "r_getRubyExportFolder_",
        "installTriggerAwningRuby_",
        "handleEditLeanToRuby_",
        "installTriggerLeanToRuby_",
        "copyRubyForSelectedRow_"
      ],
      "lines": 921,
      "size": 30253
    },
    {
      "path": "Macros.gs",
      "filename": "Macros.gs",
      "purpose": "Macro wrapper for Copy Ruby function Keyboard shortcut: Ctrl+Alt+Shift+1 (or assigned number)",
      "version": null,
      "functions": [
        {
          "name": "CopyRuby",
          "line": 5,
          "description": "Macro wrapper for Copy Ruby function Keyboard shortcut: Ctrl+Alt+Shift+1 (or assigned number)",
          "isPublic": true,
          "isHelper": false
        }
      ],
      "triggers": [],
      "dependencies": [
        "copyRubyForSelectedRow_"
      ],
      "lines": 7,
      "size": 166
    },
    {
      "path": "Menus.gs",
      "filename": "Menus.gs",
      "purpose": "Menus.gs Version: 1/16 9am EST by Claude Sonnet 4.5 CHANGES:",
      "version": "1/16 9am EST by Claude Sonnet 4.5",
      "functions": [
        {
          "name": "onOpen",
          "line": 9,
          "description": "CHANGES: - Updated Email Reader menu with separate options for Ruby vs Add lead - Removed Gemini Leads menu (consolidated into Email Reader)",
          "isPublic": true,
          "isHelper": false
        },
        {
          "name": "showQuickBooksSetup_",
          "line": 93,
          "description": "Show QuickBooks setup instructions",
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "listAllTriggers_",
          "line": 161,
          "description": "System utility: List all triggers",
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "removeAllTriggers_",
          "line": 180,
          "description": "System utility: Remove all triggers",
          "isPublic": false,
          "isHelper": true
        }
      ],
      "triggers": [],
      "dependencies": [
        "showQuickBooksSetup_",
        "listAllTriggers_",
        "removeAllTriggers_"
      ],
      "lines": 191,
      "size": 6371
    },
    {
      "path": "Miles Log.gs",
      "filename": "Miles Log.gs",
      "purpose": "Miles Log Version 8.1 [09/10-11:00AM EST] by Claude Opus 4.1 Features:",
      "version": "8.1 [09/10-11:00AM EST] by Claude Opus 4.1",
      "functions": [
        {
          "name": "installTriggerMileage_",
          "line": 50,
          "description": "======================== MAIN ========================",
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "runMileageSync_",
          "line": 66,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "ml_processEvents",
          "line": 113,
          "description": "======================== PROCESSING ========================",
          "isPublic": true,
          "isHelper": true
        },
        {
          "name": "ml_groupEventsByDate",
          "line": 130,
          "description": null,
          "isPublic": true,
          "isHelper": true
        },
        {
          "name": "ml_processDayEvents",
          "line": 140,
          "description": null,
          "isPublic": true,
          "isHelper": true
        },
        {
          "name": "ml_getOrdinal",
          "line": 209,
          "description": "======================== UTILITIES ========================",
          "isPublic": true,
          "isHelper": true
        },
        {
          "name": "ml_getMileageSheet",
          "line": 215,
          "description": null,
          "isPublic": true,
          "isHelper": true
        },
        {
          "name": "ml_validateSheet",
          "line": 222,
          "description": null,
          "isPublic": true,
          "isHelper": true
        },
        {
          "name": "ml_getDateBoundaries",
          "line": 232,
          "description": null,
          "isPublic": true,
          "isHelper": true
        },
        {
          "name": "ml_getExistingDates",
          "line": 248,
          "description": null,
          "isPublic": true,
          "isHelper": true
        },
        {
          "name": "ml_getCalendarEventsChunked",
          "line": 264,
          "description": null,
          "isPublic": true,
          "isHelper": true
        },
        {
          "name": "ml_getCalendarEvents",
          "line": 277,
          "description": null,
          "isPublic": true,
          "isHelper": true
        },
        {
          "name": "ml_getEventAddress",
          "line": 283,
          "description": null,
          "isPublic": true,
          "isHelper": true
        },
        {
          "name": "ml_extractAddress",
          "line": 287,
          "description": null,
          "isPublic": true,
          "isHelper": true
        },
        {
          "name": "ml_isOfficeAddress",
          "line": 297,
          "description": null,
          "isPublic": true,
          "isHelper": true
        },
        {
          "name": "ml_calculateDistance",
          "line": 304,
          "description": null,
          "isPublic": true,
          "isHelper": true
        },
        {
          "name": "ml_flagDistance",
          "line": 315,
          "description": null,
          "isPublic": true,
          "isHelper": true
        },
        {
          "name": "ml_formatDate",
          "line": 319,
          "description": null,
          "isPublic": true,
          "isHelper": true
        },
        {
          "name": "ml_createCalendarLink",
          "line": 326,
          "description": null,
          "isPublic": true,
          "isHelper": true
        },
        {
          "name": "ml_createMapsLink",
          "line": 331,
          "description": null,
          "isPublic": true,
          "isHelper": true
        },
        {
          "name": "ml_getTimestamp",
          "line": 335,
          "description": null,
          "isPublic": true,
          "isHelper": true
        },
        {
          "name": "ml_addEntriesToSheet",
          "line": 343,
          "description": "======================== BATCH WRITER (optimized) ========================",
          "isPublic": true,
          "isHelper": true
        },
        {
          "name": "ml_isReturnToOfficeEvent",
          "line": 394,
          "description": null,
          "isPublic": true,
          "isHelper": true
        },
        {
          "name": "ml_getGradientColor",
          "line": 399,
          "description": null,
          "isPublic": true,
          "isHelper": true
        },
        {
          "name": "ml_addEntriesToSheet",
          "line": 415,
          "description": null,
          "isPublic": true,
          "isHelper": true
        }
      ],
      "triggers": [],
      "dependencies": [
        "installTriggerMileage_",
        "runMileageSync_",
        "MILEAGE_CONFIG",
        "Defines: MILEAGE_CONFIG"
      ],
      "lines": 474,
      "size": 16349
    },
    {
      "path": "QBO Estimates.gs",
      "filename": "QBO Estimates.gs",
      "purpose": "QBO ESTIMATES - QuickBooks Online Integration Version: 1/16 9am EST by Claude Sonnet 4.5 by Claude Opus 4.1",
      "version": "1/16 9am EST by Claude Sonnet 4.5",
      "functions": [
        {
          "name": "convertEstimateToInvoice",
          "line": 16,
          "description": "Convert estimate to invoice for awarded jobs Run this from Awarded sheet with active cell on the row to convert",
          "isPublic": true,
          "isHelper": false
        },
        {
          "name": "sendEstimateCurrentRow_",
          "line": 180,
          "description": "Send estimate for current row in Leads sheet to QuickBooks Shows approval dialog with customer info before creating",
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "findOrCreateCustomer_",
          "line": 376,
          "description": "Helper: Find existing customer or create new one in QuickBooks",
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "parseAddress_",
          "line": 425,
          "description": "Helper: Parse address string into QuickBooks address object",
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "configureEnvironment",
          "line": 443,
          "description": "Configure QuickBooks environment (production vs sandbox)",
          "isPublic": true,
          "isHelper": false
        },
        {
          "name": "listQuickBooksItems",
          "line": 465,
          "description": "Debug: List all QuickBooks items (for line item configuration)",
          "isPublic": true,
          "isHelper": false
        }
      ],
      "triggers": [],
      "dependencies": [
        "sendEstimateCurrentRow_",
        "findOrCreateCustomer_",
        "parseAddress_"
      ],
      "lines": 509,
      "size": 17215
    },
    {
      "path": "QuickBooksAuth.gs",
      "filename": "QuickBooksAuth.gs",
      "purpose": "QUICKBOOKS AUTH (OAuth2 setup) Version: 1/16 9am EST by Claude Sonnet 4.5 by Claude Opus 4.1",
      "version": "1/16 9am EST by Claude Sonnet 4.5",
      "functions": [
        {
          "name": "getScriptUrl",
          "line": 22,
          "description": "Get the current web app URL - MUST run this after deploying as web app",
          "isPublic": true,
          "isHelper": false
        },
        {
          "name": "getOAuthService",
          "line": 36,
          "description": "Initialize OAuth2 service for QuickBooks",
          "isPublic": true,
          "isHelper": false
        },
        {
          "name": "resetAuth",
          "line": 66,
          "description": "Clear stored authentication credentials",
          "isPublic": true,
          "isHelper": false
        },
        {
          "name": "authorize",
          "line": 84,
          "description": "Triggered from menu → \"Authorize QuickBooks\" Opens authorization in a modal with a clickable link",
          "isPublic": true,
          "isHelper": false
        },
        {
          "name": "authCallback",
          "line": 195,
          "description": "OAuth2 callback handler",
          "isPublic": true,
          "isHelper": false
        },
        {
          "name": "doGet",
          "line": 315,
          "description": "Web app entry point - MUST be deployed as web app",
          "isPublic": true,
          "isHelper": false
        },
        {
          "name": "testQuickBooksConnection_",
          "line": 399,
          "description": "Test QuickBooks connection",
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "showRedirectUri_",
          "line": 477,
          "description": "Helper function to show current redirect URI and setup instructions",
          "isPublic": false,
          "isHelper": true
        }
      ],
      "triggers": [],
      "dependencies": [
        "testQuickBooksConnection_",
        "showRedirectUri_"
      ],
      "lines": 501,
      "size": 16676
    },
    {
      "path": "Stage Automation.gs",
      "filename": "Stage Automation.gs",
      "purpose": "STAGE AUTOMATION (standalone) Moves rows between sheets, creates Drive folders, writes Google Earth links, formats hyperlink cells, PRESERVES rich links/notes on row moves,",
      "version": null,
      "functions": [
        {
          "name": "handleEditMove_",
          "line": 107,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "m_autoSortByStage_",
          "line": 193,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "updateJobDescription_",
          "line": 239,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "handleDisplayNameChange_",
          "line": 314,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "handleEmailChange_",
          "line": 353,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "handleAddressChange_",
          "line": 387,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "createEarthLink_",
          "line": 417,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "handleQbUrlChange_",
          "line": 450,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "handleStageChange_",
          "line": 467,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "moveRow_",
          "line": 598,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "m_searchAndLinkSentEmail_",
          "line": 659,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "m_linkQuoteSentEmail_",
          "line": 741,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "m_createPrintPacket_",
          "line": 848,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "createNextDayGinoEvent_",
          "line": 1055,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "testCalendarAccess_",
          "line": 1134,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "m_stageMatches_",
          "line": 1145,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "m_looksLikeUrl_",
          "line": 1149,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "m_getUrlFromCell_",
          "line": 1153,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "m_cleanAddressForGoogleEarth_",
          "line": 1183,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "m_geocodeAddress_",
          "line": 1200,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "m_extractCoordinates_",
          "line": 1223,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "m_logOperation_",
          "line": 1233,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "testDriveAccess_",
          "line": 1240,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "validateSheetStructure_",
          "line": 1251,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "installTriggerMove_",
          "line": 1296,
          "description": null,
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "checkEmptyFoldersDaily_",
          "line": 1311,
          "description": "Check empty folders daily at 7am (time-driven trigger)",
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "checkEmptyFoldersNow_",
          "line": 1346,
          "description": "Check empty folders immediately (manual trigger from menu)",
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "m_checkEmptyFoldersInSheet_",
          "line": 1375,
          "description": "Check all folders in a single sheet and highlight empty ones",
          "isPublic": false,
          "isHelper": true
        },
        {
          "name": "installDailyFolderCheckTrigger_",
          "line": 1460,
          "description": "Install daily folder check trigger (7am)",
          "isPublic": false,
          "isHelper": true
        }
      ],
      "triggers": [
        {
          "type": "stage_mapping",
          "key": "quote_sent",
          "words": [
            "quote sent",
            "quoted",
            "estimate sent",
            "sent"
          ],
          "primary": "quote sent"
        },
        {
          "type": "stage_mapping",
          "key": "awarded",
          "words": [
            "awarded",
            "won",
            "accepted",
            "approved",
            "waiting on deposit",
            "deposit"
          ],
          "primary": "awarded"
        },
        {
          "type": "stage_mapping",
          "key": "archive",
          "words": [
            "archive",
            "archived",
            "closed"
          ],
          "primary": "archive"
        },
        {
          "type": "stage_mapping",
          "key": "lost",
          "words": [
            "lost",
            "declined",
            "rejected",
            "cancelled"
          ],
          "primary": "lost"
        },
        {
          "type": "stage_mapping",
          "key": "heaven",
          "words": [
            "heaven",
            "installed",
            "complete",
            "completed",
            "done",
            "pending review"
          ],
          "primary": "heaven"
        },
        {
          "type": "stage_mapping",
          "key": "revise",
          "words": [
            "revise",
            "revision",
            "needs revision"
          ],
          "primary": "revise"
        },
        {
          "type": "stage_mapping",
          "key": "schedule",
          "words": [
            "2. sched",
            "schedule",
            "sched"
          ],
          "primary": "2. sched"
        },
        {
          "type": "stage_mapping",
          "key": "print_folder",
          "words": [
            "print folder",
            "print packet",
            "print"
          ],
          "primary": "print folder"
        },
        {
          "type": "column_trigger",
          "column": "F",
          "name": "Display Name",
          "automated": true
        },
        {
          "type": "column_trigger",
          "column": "I",
          "name": "Email",
          "automated": true
        },
        {
          "type": "column_trigger",
          "column": "J",
          "name": "Address",
          "automated": true
        },
        {
          "type": "column_trigger",
          "column": "M",
          "name": "Job Description",
          "automated": true
        },
        {
          "type": "column_trigger",
          "column": "P",
          "name": "QB URL",
          "automated": true
        },
        {
          "type": "column_trigger",
          "column": "Q",
          "name": "Earth Link",
          "automated": true
        }
      ],
      "dependencies": [
        "handleEditMove_",
        "m_logOperation_",
        "handleDisplayNameChange_",
        "handleEmailChange_",
        "handleAddressChange_",
        "updateJobDescription_",
        "handleQbUrlChange_",
        "handleStageChange_",
        "m_autoSortByStage_",
        "m_checkEmptyFoldersInSheet_",
        "createEarthLink_",
        "m_geocodeAddress_",
        "m_cleanAddressForGoogleEarth_",
        "m_getUrlFromCell_",
        "m_stageMatches_",
        "createNextDayGinoEvent_",
        "m_createPrintPacket_",
        "m_linkQuoteSentEmail_",
        "moveRow_",
        "m_searchAndLinkSentEmail_",
        "testCalendarAccess_",
        "m_looksLikeUrl_",
        "m_extractCoordinates_",
        "testDriveAccess_",
        "validateSheetStructure_",
        "installTriggerMove_",
        "checkEmptyFoldersDaily_",
        "checkEmptyFoldersNow_",
        "installDailyFolderCheckTrigger_",
        "MOVE_CONFIG",
        "Defines: MOVE_CONFIG"
      ],
      "lines": 1484,
      "size": 53923
    }
  ],
  "categories": {
    "core": [
      {
        "path": "Draft Creator.gs",
        "filename": "Draft Creator.gs",
        "purpose": "Draft Creator.gs Version: 1/16 9am EST by Claude Sonnet 4.5 PURPOSE",
        "version": "1/16 9am EST by Claude Sonnet 4.5",
        "functions": [
          {
            "name": "installTriggerDrafts_V2",
            "line": 188,
            "description": null,
            "isPublic": true,
            "isHelper": true
          },
          {
            "name": "handleEditDraft_V2",
            "line": 207,
            "description": null,
            "isPublic": true,
            "isHelper": true
          },
          {
            "name": "v2_searchAndLinkEmail_",
            "line": 289,
            "description": "Search Gmail for existing emails/drafts and link in column B",
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "v2_createCustomerDraft_",
            "line": 379,
            "description": "Create customer follow-up draft when \"Email customer\" is selected",
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "v2_createHandoffDraft_",
            "line": 484,
            "description": "Create customer handoff draft when \"Cust Handoff\" is selected",
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "v2_createCustomerInfoDraft_",
            "line": 560,
            "description": "Create customer info request draft when \"Customer Info\" is selected",
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "v2_createCOIDraft_",
            "line": 777,
            "description": "Create COI request draft when \"COI Req\" is selected",
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "v2_createRoughQuote_",
            "line": 928,
            "description": "Create rough quote draft/message when \"Rough quote\" is selected",
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "createDraftsForAllRows_V2",
            "line": 1041,
            "description": null,
            "isPublic": true,
            "isHelper": true
          },
          {
            "name": "v2_createDraftForRow_",
            "line": 1088,
            "description": "Row → Draft creation ========================= */",
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "v2_exportRecoverRangeAsHtml_",
            "line": 1214,
            "description": "HTML export of Re-cover range (FIXED VERSION) Uses proper A1 notation in the API call",
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "v2_sheetsDataToHtml_",
            "line": 1256,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "v2_buildHtmlBody_",
            "line": 1390,
            "description": "Email body builders ================ */",
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "v2_buildPlainBody_",
            "line": 1449,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "d_extractUrlFromCell_",
            "line": 1461,
            "description": "Helpers ===================== */",
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "d_looksLikeUrl_",
            "line": 1511,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "d_safeString_",
            "line": 1512,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "d_htmlEscape_",
            "line": 1513,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "d_colLetterToIndex_",
            "line": 1515,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "v2_getSpreadsheet_",
            "line": 1521,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "d_writeB_",
            "line": 1528,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "d_withRetry_",
            "line": 1539,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "d_specificErrorMessage_",
            "line": 1555,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "d_shortErr_",
            "line": 1562,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "v2_validateConfig_",
            "line": 1564,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "d_isValidEmail_",
            "line": 1571,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "d_firstLinkInRichText_",
            "line": 1573,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "d_isGmailDraftUrl_",
            "line": 1585,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "d_templateSafe_",
            "line": 1589,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "d_timestamp_",
            "line": 1601,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "d_safeLogErrorToSheet_",
            "line": 1607,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "d_generateRouteMapUrl_",
            "line": 1623,
            "description": "Generate Google Maps Static API URL for route image with distance/time data Returns object: { mapUrl, distance, duration } or null on failure",
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "d_generateSimpleMapUrl_",
            "line": 1691,
            "description": "Fallback: Generate simple map URL with just markers (no route line)",
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "testMapsApiConnection",
            "line": 1705,
            "description": "Test function - run this to verify Maps API works",
            "isPublic": true,
            "isHelper": false
          },
          {
            "name": "d_generateSatelliteMapUrl_",
            "line": 1722,
            "description": "Generate Google Maps Static API satellite view URL for a location Returns the satellite image URL or null on failure",
            "isPublic": false,
            "isHelper": true
          }
        ],
        "triggers": [
          {
            "type": "draft_stage",
            "key": "TARGET_STAGE",
            "words": [
              "qDraft"
            ],
            "primary": "qDraft"
          },
          {
            "type": "draft_stage",
            "key": "LIZ_STAGE",
            "words": [
              "Liz"
            ],
            "primary": "Liz"
          },
          {
            "type": "draft_stage",
            "key": "CUSTOMER_STAGE",
            "words": [
              "Email customer"
            ],
            "primary": "Email customer"
          },
          {
            "type": "draft_stage",
            "key": "HANDOFF_STAGE",
            "words": [
              "Cust Handoff"
            ],
            "primary": "Cust Handoff"
          },
          {
            "type": "draft_stage",
            "key": "ROUGH_QUOTE_STAGE",
            "words": [
              "Rough quote"
            ],
            "primary": "Rough quote"
          },
          {
            "type": "draft_stage",
            "key": "COI_STAGE",
            "words": [
              "COI Req"
            ],
            "primary": "COI Req"
          }
        ],
        "dependencies": [
          "v2_validateConfig_",
          "v2_getSpreadsheet_",
          "d_colLetterToIndex_",
          "v2_searchAndLinkEmail_",
          "v2_createCustomerDraft_",
          "v2_createHandoffDraft_",
          "v2_createRoughQuote_",
          "v2_createCustomerInfoDraft_",
          "v2_createCOIDraft_",
          "v2_createDraftForRow_",
          "d_shortErr_",
          "d_safeString_",
          "d_extractUrlFromCell_",
          "d_isValidEmail_",
          "d_templateSafe_",
          "d_htmlEscape_",
          "d_withRetry_",
          "d_specificErrorMessage_",
          "d_firstLinkInRichText_",
          "d_isGmailDraftUrl_",
          "d_generateRouteMapUrl_",
          "d_generateSatelliteMapUrl_",
          "v2_exportRecoverRangeAsHtml_",
          "v2_buildHtmlBody_",
          "v2_buildPlainBody_",
          "d_writeB_",
          "v2_sheetsDataToHtml_",
          "d_looksLikeUrl_",
          "d_timestamp_",
          "d_safeLogErrorToSheet_",
          "d_generateSimpleMapUrl_",
          "DRAFTS_V2"
        ],
        "lines": 1744,
        "size": 69799
      },
      {
        "path": "Stage Automation.gs",
        "filename": "Stage Automation.gs",
        "purpose": "STAGE AUTOMATION (standalone) Moves rows between sheets, creates Drive folders, writes Google Earth links, formats hyperlink cells, PRESERVES rich links/notes on row moves,",
        "version": null,
        "functions": [
          {
            "name": "handleEditMove_",
            "line": 107,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "m_autoSortByStage_",
            "line": 193,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "updateJobDescription_",
            "line": 239,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "handleDisplayNameChange_",
            "line": 314,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "handleEmailChange_",
            "line": 353,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "handleAddressChange_",
            "line": 387,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "createEarthLink_",
            "line": 417,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "handleQbUrlChange_",
            "line": 450,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "handleStageChange_",
            "line": 467,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "moveRow_",
            "line": 598,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "m_searchAndLinkSentEmail_",
            "line": 659,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "m_linkQuoteSentEmail_",
            "line": 741,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "m_createPrintPacket_",
            "line": 848,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "createNextDayGinoEvent_",
            "line": 1055,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "testCalendarAccess_",
            "line": 1134,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "m_stageMatches_",
            "line": 1145,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "m_looksLikeUrl_",
            "line": 1149,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "m_getUrlFromCell_",
            "line": 1153,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "m_cleanAddressForGoogleEarth_",
            "line": 1183,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "m_geocodeAddress_",
            "line": 1200,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "m_extractCoordinates_",
            "line": 1223,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "m_logOperation_",
            "line": 1233,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "testDriveAccess_",
            "line": 1240,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "validateSheetStructure_",
            "line": 1251,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "installTriggerMove_",
            "line": 1296,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "checkEmptyFoldersDaily_",
            "line": 1311,
            "description": "Check empty folders daily at 7am (time-driven trigger)",
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "checkEmptyFoldersNow_",
            "line": 1346,
            "description": "Check empty folders immediately (manual trigger from menu)",
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "m_checkEmptyFoldersInSheet_",
            "line": 1375,
            "description": "Check all folders in a single sheet and highlight empty ones",
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "installDailyFolderCheckTrigger_",
            "line": 1460,
            "description": "Install daily folder check trigger (7am)",
            "isPublic": false,
            "isHelper": true
          }
        ],
        "triggers": [
          {
            "type": "stage_mapping",
            "key": "quote_sent",
            "words": [
              "quote sent",
              "quoted",
              "estimate sent",
              "sent"
            ],
            "primary": "quote sent"
          },
          {
            "type": "stage_mapping",
            "key": "awarded",
            "words": [
              "awarded",
              "won",
              "accepted",
              "approved",
              "waiting on deposit",
              "deposit"
            ],
            "primary": "awarded"
          },
          {
            "type": "stage_mapping",
            "key": "archive",
            "words": [
              "archive",
              "archived",
              "closed"
            ],
            "primary": "archive"
          },
          {
            "type": "stage_mapping",
            "key": "lost",
            "words": [
              "lost",
              "declined",
              "rejected",
              "cancelled"
            ],
            "primary": "lost"
          },
          {
            "type": "stage_mapping",
            "key": "heaven",
            "words": [
              "heaven",
              "installed",
              "complete",
              "completed",
              "done",
              "pending review"
            ],
            "primary": "heaven"
          },
          {
            "type": "stage_mapping",
            "key": "revise",
            "words": [
              "revise",
              "revision",
              "needs revision"
            ],
            "primary": "revise"
          },
          {
            "type": "stage_mapping",
            "key": "schedule",
            "words": [
              "2. sched",
              "schedule",
              "sched"
            ],
            "primary": "2. sched"
          },
          {
            "type": "stage_mapping",
            "key": "print_folder",
            "words": [
              "print folder",
              "print packet",
              "print"
            ],
            "primary": "print folder"
          },
          {
            "type": "column_trigger",
            "column": "F",
            "name": "Display Name",
            "automated": true
          },
          {
            "type": "column_trigger",
            "column": "I",
            "name": "Email",
            "automated": true
          },
          {
            "type": "column_trigger",
            "column": "J",
            "name": "Address",
            "automated": true
          },
          {
            "type": "column_trigger",
            "column": "M",
            "name": "Job Description",
            "automated": true
          },
          {
            "type": "column_trigger",
            "column": "P",
            "name": "QB URL",
            "automated": true
          },
          {
            "type": "column_trigger",
            "column": "Q",
            "name": "Earth Link",
            "automated": true
          }
        ],
        "dependencies": [
          "handleEditMove_",
          "m_logOperation_",
          "handleDisplayNameChange_",
          "handleEmailChange_",
          "handleAddressChange_",
          "updateJobDescription_",
          "handleQbUrlChange_",
          "handleStageChange_",
          "m_autoSortByStage_",
          "m_checkEmptyFoldersInSheet_",
          "createEarthLink_",
          "m_geocodeAddress_",
          "m_cleanAddressForGoogleEarth_",
          "m_getUrlFromCell_",
          "m_stageMatches_",
          "createNextDayGinoEvent_",
          "m_createPrintPacket_",
          "m_linkQuoteSentEmail_",
          "moveRow_",
          "m_searchAndLinkSentEmail_",
          "testCalendarAccess_",
          "m_looksLikeUrl_",
          "m_extractCoordinates_",
          "testDriveAccess_",
          "validateSheetStructure_",
          "installTriggerMove_",
          "checkEmptyFoldersDaily_",
          "checkEmptyFoldersNow_",
          "installDailyFolderCheckTrigger_",
          "MOVE_CONFIG",
          "Defines: MOVE_CONFIG"
        ],
        "lines": 1484,
        "size": 53923
      }
    ],
    "automation": [
      {
        "path": "Lean-to generator.gs",
        "filename": "Lean-to generator.gs",
        "purpose": "LEAN-TO & A-FRAME RUBY (Exact) — Drive File Export Version: 1/16 9am EST by Claude Sonnet 4.5 Triggers on edits to Leads!T:AD (cols 20–30) when AA contains:",
        "version": "1/16 9am EST by Claude Sonnet 4.5",
        "functions": [
          {
            "name": "handleEditAwningRuby_",
            "line": 29,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "r_buildRubyFromLeanToTemplate_",
            "line": 144,
            "description": "Replace ONLY the parameter literals in the Lean-to Ruby template. Every other character (including spacing and comments) is preserved verbatim.",
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "r_buildRubyFromAFrameTemplate_",
            "line": 196,
            "description": "Replace ONLY the parameter literals in the A-Frame Ruby template. Every other character (including spacing and comments) is preserved verbatim.",
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "r_getLeanToRubyTemplate_",
            "line": 249,
            "description": "LEAN-TO RUBY TEMPLATE — DO NOT CHANGE ANYTHING HERE. We substitute only the parameter values via r_buildRubyFromLeanToTemplate_().",
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "r_getAFrameRubyTemplate_",
            "line": 444,
            "description": "A-FRAME RUBY TEMPLATE — DO NOT CHANGE ANYTHING HERE. We substitute only the parameter values via r_buildRubyFromAFrameTemplate_().",
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "r_writeRubyToDrive_",
            "line": 698,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "r_getRubyExportFolder_",
            "line": 716,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "installTriggerAwningRuby_",
            "line": 731,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "handleEditLeanToRuby_",
            "line": 743,
            "description": "Backward compatibility wrappers for old function names",
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "installTriggerLeanToRuby_",
            "line": 747,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "r_getRubyExactTemplate",
            "line": 751,
            "description": null,
            "isPublic": true,
            "isHelper": true
          },
          {
            "name": "copyRubyForSelectedRow_",
            "line": 758,
            "description": "Copy Ruby code for the selected row to clipboard via dialog Version# [12/29-10:45AM EST] by Claude Opus 4.1",
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "copyCode",
            "line": 885,
            "description": null,
            "isPublic": true,
            "isHelper": false
          }
        ],
        "triggers": [],
        "dependencies": [
          "handleEditAwningRuby_",
          "r_buildRubyFromLeanToTemplate_",
          "r_buildRubyFromAFrameTemplate_",
          "r_writeRubyToDrive_",
          "r_getLeanToRubyTemplate_",
          "r_getAFrameRubyTemplate_",
          "r_getRubyExportFolder_",
          "installTriggerAwningRuby_",
          "handleEditLeanToRuby_",
          "installTriggerLeanToRuby_",
          "copyRubyForSelectedRow_"
        ],
        "lines": 921,
        "size": 30253
      }
    ],
    "integration": [
      {
        "path": "QBO Estimates.gs",
        "filename": "QBO Estimates.gs",
        "purpose": "QBO ESTIMATES - QuickBooks Online Integration Version: 1/16 9am EST by Claude Sonnet 4.5 by Claude Opus 4.1",
        "version": "1/16 9am EST by Claude Sonnet 4.5",
        "functions": [
          {
            "name": "convertEstimateToInvoice",
            "line": 16,
            "description": "Convert estimate to invoice for awarded jobs Run this from Awarded sheet with active cell on the row to convert",
            "isPublic": true,
            "isHelper": false
          },
          {
            "name": "sendEstimateCurrentRow_",
            "line": 180,
            "description": "Send estimate for current row in Leads sheet to QuickBooks Shows approval dialog with customer info before creating",
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "findOrCreateCustomer_",
            "line": 376,
            "description": "Helper: Find existing customer or create new one in QuickBooks",
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "parseAddress_",
            "line": 425,
            "description": "Helper: Parse address string into QuickBooks address object",
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "configureEnvironment",
            "line": 443,
            "description": "Configure QuickBooks environment (production vs sandbox)",
            "isPublic": true,
            "isHelper": false
          },
          {
            "name": "listQuickBooksItems",
            "line": 465,
            "description": "Debug: List all QuickBooks items (for line item configuration)",
            "isPublic": true,
            "isHelper": false
          }
        ],
        "triggers": [],
        "dependencies": [
          "sendEstimateCurrentRow_",
          "findOrCreateCustomer_",
          "parseAddress_"
        ],
        "lines": 509,
        "size": 17215
      },
      {
        "path": "QuickBooksAuth.gs",
        "filename": "QuickBooksAuth.gs",
        "purpose": "QUICKBOOKS AUTH (OAuth2 setup) Version: 1/16 9am EST by Claude Sonnet 4.5 by Claude Opus 4.1",
        "version": "1/16 9am EST by Claude Sonnet 4.5",
        "functions": [
          {
            "name": "getScriptUrl",
            "line": 22,
            "description": "Get the current web app URL - MUST run this after deploying as web app",
            "isPublic": true,
            "isHelper": false
          },
          {
            "name": "getOAuthService",
            "line": 36,
            "description": "Initialize OAuth2 service for QuickBooks",
            "isPublic": true,
            "isHelper": false
          },
          {
            "name": "resetAuth",
            "line": 66,
            "description": "Clear stored authentication credentials",
            "isPublic": true,
            "isHelper": false
          },
          {
            "name": "authorize",
            "line": 84,
            "description": "Triggered from menu → \"Authorize QuickBooks\" Opens authorization in a modal with a clickable link",
            "isPublic": true,
            "isHelper": false
          },
          {
            "name": "authCallback",
            "line": 195,
            "description": "OAuth2 callback handler",
            "isPublic": true,
            "isHelper": false
          },
          {
            "name": "doGet",
            "line": 315,
            "description": "Web app entry point - MUST be deployed as web app",
            "isPublic": true,
            "isHelper": false
          },
          {
            "name": "testQuickBooksConnection_",
            "line": 399,
            "description": "Test QuickBooks connection",
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "showRedirectUri_",
            "line": 477,
            "description": "Helper function to show current redirect URI and setup instructions",
            "isPublic": false,
            "isHelper": true
          }
        ],
        "triggers": [],
        "dependencies": [
          "testQuickBooksConnection_",
          "showRedirectUri_"
        ],
        "lines": 501,
        "size": 16676
      }
    ],
    "utilities": [
      {
        "path": "Menus.gs",
        "filename": "Menus.gs",
        "purpose": "Menus.gs Version: 1/16 9am EST by Claude Sonnet 4.5 CHANGES:",
        "version": "1/16 9am EST by Claude Sonnet 4.5",
        "functions": [
          {
            "name": "onOpen",
            "line": 9,
            "description": "CHANGES: - Updated Email Reader menu with separate options for Ruby vs Add lead - Removed Gemini Leads menu (consolidated into Email Reader)",
            "isPublic": true,
            "isHelper": false
          },
          {
            "name": "showQuickBooksSetup_",
            "line": 93,
            "description": "Show QuickBooks setup instructions",
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "listAllTriggers_",
            "line": 161,
            "description": "System utility: List all triggers",
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "removeAllTriggers_",
            "line": 180,
            "description": "System utility: Remove all triggers",
            "isPublic": false,
            "isHelper": true
          }
        ],
        "triggers": [],
        "dependencies": [
          "showQuickBooksSetup_",
          "listAllTriggers_",
          "removeAllTriggers_"
        ],
        "lines": 191,
        "size": 6371
      }
    ],
    "other": [
      {
        "path": "Email Reader.gs",
        "filename": "Email Reader.gs",
        "purpose": "EMAIL READER AUTOMATION - UNIFIED LEAD INGESTION Version: 1/16 9am EST by Claude Sonnet 4.5 FEATURES:",
        "version": "1/16 9am EST by Claude Sonnet 4.5",
        "functions": [
          {
            "name": "er_buildCSV_",
            "line": 117,
            "description": "Build a 29-column CSV string from extracted data Columns: A-AC (Date through Awning Type)",
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "er_diagnosticCheck",
            "line": 151,
            "description": "DIAGNOSTIC FUNCTION - Quick check, no popup",
            "isPublic": true,
            "isHelper": true
          },
          {
            "name": "er_isRubyEmail_",
            "line": 177,
            "description": "Determine if email is from Ruby",
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "er_processEmail_",
            "line": 186,
            "description": "Process a single email - writes CSV to column A Stage Automation will split it across columns",
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "er_extractWithPatterns_",
            "line": 329,
            "description": "Extract data using pattern matching",
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "er_extractStructured_",
            "line": 434,
            "description": "Extract data using structured key:value parsing",
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "er_log_",
            "line": 508,
            "description": "Logging function",
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "er_installTrigger",
            "line": 521,
            "description": "Install trigger - runs every 15 minutes for BOTH Ruby and \"Add lead\"",
            "isPublic": true,
            "isHelper": true
          },
          {
            "name": "er_removeTrigger",
            "line": 539,
            "description": "Remove trigger",
            "isPublic": true,
            "isHelper": true
          },
          {
            "name": "er_processNewEmails",
            "line": 552,
            "description": "MAIN: Process ALL pending emails (Ruby + Add lead) - runs automatically",
            "isPublic": true,
            "isHelper": true
          },
          {
            "name": "er_processAddLeadEmails",
            "line": 625,
            "description": "Process only \"Add lead\" emails manually",
            "isPublic": true,
            "isHelper": true
          },
          {
            "name": "er_testProcessing",
            "line": 667,
            "description": "Test processing - no popup, just runs and shows toast",
            "isPublic": true,
            "isHelper": true
          }
        ],
        "triggers": [],
        "dependencies": [
          "er_buildCSV_",
          "er_log_",
          "er_isRubyEmail_",
          "er_processEmail_",
          "er_extractWithPatterns_",
          "er_extractStructured_",
          "Defines: EMAIL_READER_CONFIG"
        ],
        "lines": 719,
        "size": 21959
      },
      {
        "path": "Lead follow up.gs.gs",
        "filename": "Lead follow up.gs.gs",
        "purpose": "Lead Follow up.gs Version: 1/16 9am EST by Claude Sonnet 4.5 PURPOSE",
        "version": "1/16 9am EST by Claude Sonnet 4.5",
        "functions": [
          {
            "name": "installTriggerDrafts_FU",
            "line": 35,
            "description": null,
            "isPublic": true,
            "isHelper": true
          },
          {
            "name": "handleEditDraft_FU",
            "line": 48,
            "description": null,
            "isPublic": true,
            "isHelper": true
          },
          {
            "name": "createDraftsForAllRows_FU",
            "line": 80,
            "description": null,
            "isPublic": true,
            "isHelper": true
          },
          {
            "name": "fu_createDraftForRow_",
            "line": 127,
            "description": "Row → Draft creation ========================= */",
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "fu_safeString_",
            "line": 173,
            "description": "Helpers ===================== */",
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "fu_colLetterToIndex_",
            "line": 174,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "fu_getSpreadsheet_",
            "line": 179,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "fu_writeB_",
            "line": 185,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "fu_firstLinkInRichText_",
            "line": 195,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "fu_isGmailDraftUrl_",
            "line": 206,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "fu_shortErr_",
            "line": 210,
            "description": null,
            "isPublic": false,
            "isHelper": true
          }
        ],
        "triggers": [],
        "dependencies": [
          "fu_getSpreadsheet_",
          "fu_colLetterToIndex_",
          "fu_firstLinkInRichText_",
          "fu_isGmailDraftUrl_",
          "fu_createDraftForRow_",
          "fu_shortErr_",
          "fu_safeString_",
          "fu_writeB_"
        ],
        "lines": 212,
        "size": 7741
      },
      {
        "path": "Macros.gs",
        "filename": "Macros.gs",
        "purpose": "Macro wrapper for Copy Ruby function Keyboard shortcut: Ctrl+Alt+Shift+1 (or assigned number)",
        "version": null,
        "functions": [
          {
            "name": "CopyRuby",
            "line": 5,
            "description": "Macro wrapper for Copy Ruby function Keyboard shortcut: Ctrl+Alt+Shift+1 (or assigned number)",
            "isPublic": true,
            "isHelper": false
          }
        ],
        "triggers": [],
        "dependencies": [
          "copyRubyForSelectedRow_"
        ],
        "lines": 7,
        "size": 166
      },
      {
        "path": "Miles Log.gs",
        "filename": "Miles Log.gs",
        "purpose": "Miles Log Version 8.1 [09/10-11:00AM EST] by Claude Opus 4.1 Features:",
        "version": "8.1 [09/10-11:00AM EST] by Claude Opus 4.1",
        "functions": [
          {
            "name": "installTriggerMileage_",
            "line": 50,
            "description": "======================== MAIN ========================",
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "runMileageSync_",
            "line": 66,
            "description": null,
            "isPublic": false,
            "isHelper": true
          },
          {
            "name": "ml_processEvents",
            "line": 113,
            "description": "======================== PROCESSING ========================",
            "isPublic": true,
            "isHelper": true
          },
          {
            "name": "ml_groupEventsByDate",
            "line": 130,
            "description": null,
            "isPublic": true,
            "isHelper": true
          },
          {
            "name": "ml_processDayEvents",
            "line": 140,
            "description": null,
            "isPublic": true,
            "isHelper": true
          },
          {
            "name": "ml_getOrdinal",
            "line": 209,
            "description": "======================== UTILITIES ========================",
            "isPublic": true,
            "isHelper": true
          },
          {
            "name": "ml_getMileageSheet",
            "line": 215,
            "description": null,
            "isPublic": true,
            "isHelper": true
          },
          {
            "name": "ml_validateSheet",
            "line": 222,
            "description": null,
            "isPublic": true,
            "isHelper": true
          },
          {
            "name": "ml_getDateBoundaries",
            "line": 232,
            "description": null,
            "isPublic": true,
            "isHelper": true
          },
          {
            "name": "ml_getExistingDates",
            "line": 248,
            "description": null,
            "isPublic": true,
            "isHelper": true
          },
          {
            "name": "ml_getCalendarEventsChunked",
            "line": 264,
            "description": null,
            "isPublic": true,
            "isHelper": true
          },
          {
            "name": "ml_getCalendarEvents",
            "line": 277,
            "description": null,
            "isPublic": true,
            "isHelper": true
          },
          {
            "name": "ml_getEventAddress",
            "line": 283,
            "description": null,
            "isPublic": true,
            "isHelper": true
          },
          {
            "name": "ml_extractAddress",
            "line": 287,
            "description": null,
            "isPublic": true,
            "isHelper": true
          },
          {
            "name": "ml_isOfficeAddress",
            "line": 297,
            "description": null,
            "isPublic": true,
            "isHelper": true
          },
          {
            "name": "ml_calculateDistance",
            "line": 304,
            "description": null,
            "isPublic": true,
            "isHelper": true
          },
          {
            "name": "ml_flagDistance",
            "line": 315,
            "description": null,
            "isPublic": true,
            "isHelper": true
          },
          {
            "name": "ml_formatDate",
            "line": 319,
            "description": null,
            "isPublic": true,
            "isHelper": true
          },
          {
            "name": "ml_createCalendarLink",
            "line": 326,
            "description": null,
            "isPublic": true,
            "isHelper": true
          },
          {
            "name": "ml_createMapsLink",
            "line": 331,
            "description": null,
            "isPublic": true,
            "isHelper": true
          },
          {
            "name": "ml_getTimestamp",
            "line": 335,
            "description": null,
            "isPublic": true,
            "isHelper": true
          },
          {
            "name": "ml_addEntriesToSheet",
            "line": 343,
            "description": "======================== BATCH WRITER (optimized) ========================",
            "isPublic": true,
            "isHelper": true
          },
          {
            "name": "ml_isReturnToOfficeEvent",
            "line": 394,
            "description": null,
            "isPublic": true,
            "isHelper": true
          },
          {
            "name": "ml_getGradientColor",
            "line": 399,
            "description": null,
            "isPublic": true,
            "isHelper": true
          },
          {
            "name": "ml_addEntriesToSheet",
            "line": 415,
            "description": null,
            "isPublic": true,
            "isHelper": true
          }
        ],
        "triggers": [],
        "dependencies": [
          "installTriggerMileage_",
          "runMileageSync_",
          "MILEAGE_CONFIG",
          "Defines: MILEAGE_CONFIG"
        ],
        "lines": 474,
        "size": 16349
      }
    ]
  },
  "stageMoves": [
    {
      "type": "stage_mapping",
      "key": "quote_sent",
      "words": [
        "quote sent",
        "quoted",
        "estimate sent",
        "sent"
      ],
      "primary": "quote sent"
    },
    {
      "type": "stage_mapping",
      "key": "awarded",
      "words": [
        "awarded",
        "won",
        "accepted",
        "approved",
        "waiting on deposit",
        "deposit"
      ],
      "primary": "awarded"
    },
    {
      "type": "stage_mapping",
      "key": "archive",
      "words": [
        "archive",
        "archived",
        "closed"
      ],
      "primary": "archive"
    },
    {
      "type": "stage_mapping",
      "key": "lost",
      "words": [
        "lost",
        "declined",
        "rejected",
        "cancelled"
      ],
      "primary": "lost"
    },
    {
      "type": "stage_mapping",
      "key": "heaven",
      "words": [
        "heaven",
        "installed",
        "complete",
        "completed",
        "done",
        "pending review"
      ],
      "primary": "heaven"
    },
    {
      "type": "stage_mapping",
      "key": "revise",
      "words": [
        "revise",
        "revision",
        "needs revision"
      ],
      "primary": "revise"
    },
    {
      "type": "stage_mapping",
      "key": "schedule",
      "words": [
        "2. sched",
        "schedule",
        "sched"
      ],
      "primary": "2. sched"
    },
    {
      "type": "stage_mapping",
      "key": "print_folder",
      "words": [
        "print folder",
        "print packet",
        "print"
      ],
      "primary": "print folder"
    }
  ],
  "draftCreator": [
    {
      "type": "draft_stage",
      "key": "TARGET_STAGE",
      "words": [
        "qDraft"
      ],
      "primary": "qDraft"
    },
    {
      "type": "draft_stage",
      "key": "LIZ_STAGE",
      "words": [
        "Liz"
      ],
      "primary": "Liz"
    },
    {
      "type": "draft_stage",
      "key": "CUSTOMER_STAGE",
      "words": [
        "Email customer"
      ],
      "primary": "Email customer"
    },
    {
      "type": "draft_stage",
      "key": "HANDOFF_STAGE",
      "words": [
        "Cust Handoff"
      ],
      "primary": "Cust Handoff"
    },
    {
      "type": "draft_stage",
      "key": "ROUGH_QUOTE_STAGE",
      "words": [
        "Rough quote"
      ],
      "primary": "Rough quote"
    },
    {
      "type": "draft_stage",
      "key": "COI_STAGE",
      "words": [
        "COI Req"
      ],
      "primary": "COI Req"
    }
  ],
  "autoColumns": [
    {
      "type": "column_trigger",
      "column": "F",
      "name": "Display Name",
      "automated": true
    },
    {
      "type": "column_trigger",
      "column": "I",
      "name": "Email",
      "automated": true
    },
    {
      "type": "column_trigger",
      "column": "J",
      "name": "Address",
      "automated": true
    },
    {
      "type": "column_trigger",
      "column": "M",
      "name": "Job Description",
      "automated": true
    },
    {
      "type": "column_trigger",
      "column": "P",
      "name": "QB URL",
      "automated": true
    },
    {
      "type": "column_trigger",
      "column": "Q",
      "name": "Earth Link",
      "automated": true
    }
  ]
}